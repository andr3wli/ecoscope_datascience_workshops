<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Statistical models in R | ECOSCOPE: Data Science Workshops</title>
  <meta name="description" content="UBC ECOSCOPE workshop materials in the form of a bookdown book." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Statistical models in R | ECOSCOPE: Data Science Workshops" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="UBC ECOSCOPE workshop materials in the form of a bookdown book." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Statistical models in R | ECOSCOPE: Data Science Workshops" />
  
  <meta name="twitter:description" content="UBC ECOSCOPE workshop materials in the form of a bookdown book." />
  

<meta name="author" content="Andrew Li" />
<meta name="author" content="Stephan Koenig" />


<meta name="date" content="2021-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reproducible-research-1.html"/>
<link rel="next" href="intermediate-r-programming-1.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">ECOSCOPE: Data Science Workshops</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> ECOSCOPE</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i><b>1.1</b> Schedule</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#workshops"><i class="fa fa-check"></i><b>1.2</b> Workshops</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#introduction-to-r-and-r-studio"><i class="fa fa-check"></i><b>1.2.1</b> Introduction to R and R Studio</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#introduction-to-the-tidyverse"><i class="fa fa-check"></i><b>1.2.2</b> Introduction to the tidyverse</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#reproducible-research"><i class="fa fa-check"></i><b>1.2.3</b> Reproducible research</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#statistical-models-in-r"><i class="fa fa-check"></i><b>1.2.4</b> Statistical models in R</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#intermediate-r-programming"><i class="fa fa-check"></i><b>1.2.5</b> Intermediate R programming</a></li>
<li class="chapter" data-level="1.2.6" data-path="index.html"><a href="index.html#beyond-ggplot2"><i class="fa fa-check"></i><b>1.2.6</b> Beyond ggplot2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> Introduction to R and RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>2.1.1</b> What is R?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#using-r-in-your-own-computer"><i class="fa fa-check"></i><b>2.2</b> Using R in your own computer</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> What is RStudio?</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-r-console"><i class="fa fa-check"></i><b>2.2.2</b> The R console</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-r-environment"><i class="fa fa-check"></i><b>2.2.3</b> The R Environment</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#scripts"><i class="fa fa-check"></i><b>2.2.4</b> Scripts</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.2.5</b> Installing and loading packages</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#paths-and-working-directory"><i class="fa fa-check"></i><b>2.2.6</b> Paths and working directory</a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#rstudio-projects"><i class="fa fa-check"></i><b>2.2.7</b> RStudio projects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#r-as-a-calculator"><i class="fa fa-check"></i><b>2.3</b> R as a calculator</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#assigning-variables"><i class="fa fa-check"></i><b>2.4</b> Assigning variables</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#comments"><i class="fa fa-check"></i><b>2.4.1</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#functions"><i class="fa fa-check"></i><b>2.5</b> Functions</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#the-most-helpful-function-of-all-the-help-function"><i class="fa fa-check"></i><b>2.5.1</b> The most helpful function of all: the ‘help’ function</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#data-types"><i class="fa fa-check"></i><b>2.6</b> Data types</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercises"><i class="fa fa-check"></i><b>2.6.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#structures"><i class="fa fa-check"></i><b>2.7</b> Structures</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#vectors"><i class="fa fa-check"></i><b>2.7.1</b> Vectors</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#apply-functions-over-vectors"><i class="fa fa-check"></i><b>2.7.2</b> Apply functions over vectors</a></li>
<li class="chapter" data-level="2.7.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#arithmetic-operations-on-vectors"><i class="fa fa-check"></i><b>2.7.3</b> Arithmetic operations on vectors</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#data-frames"><i class="fa fa-check"></i><b>2.8</b> Data frames</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#example-data-frame"><i class="fa fa-check"></i><b>2.8.1</b> Example data frame</a></li>
<li class="chapter" data-level="2.8.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#importing-the-data-frame"><i class="fa fa-check"></i><b>2.8.2</b> Importing the data frame</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#quick-plots"><i class="fa fa-check"></i><b>2.9</b> Quick plots</a></li>
<li class="chapter" data-level="2.10" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#accessing-and-subsetting-data"><i class="fa fa-check"></i><b>2.10</b> Accessing and subsetting data</a>
<ul>
<li class="chapter" data-level="2.10.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#acessing-vector-elements"><i class="fa fa-check"></i><b>2.10.1</b> Acessing vector elements</a></li>
<li class="chapter" data-level="2.10.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#accessing-data-frame-elements"><i class="fa fa-check"></i><b>2.10.2</b> Accessing data frame elements</a></li>
<li class="chapter" data-level="2.10.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#subsetting-rows-according-to-condition"><i class="fa fa-check"></i><b>2.10.3</b> Subsetting rows according to condition</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#additional-exercises"><i class="fa fa-check"></i><b>2.11</b> Additional exercises</a>
<ul>
<li class="chapter" data-level="2.11.1" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-1-install-packages"><i class="fa fa-check"></i><b>2.11.1</b> Exercise 1: Install packages</a></li>
<li class="chapter" data-level="2.11.2" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-2-calculating-a-probability-density"><i class="fa fa-check"></i><b>2.11.2</b> Exercise 2: Calculating a probability density</a></li>
<li class="chapter" data-level="2.11.3" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-3-use-the-help-function-to-learn-how-to-flip-coins"><i class="fa fa-check"></i><b>2.11.3</b> Exercise 3: Use the help function to learn how to flip coins</a></li>
<li class="chapter" data-level="2.11.4" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#exercise-4-working-with-data"><i class="fa fa-check"></i><b>2.11.4</b> Exercise 4: Working with data</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="introduction-to-r-and-rstudio.html"><a href="introduction-to-r-and-rstudio.html#survey"><i class="fa fa-check"></i><b>2.12</b> Survey</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html"><i class="fa fa-check"></i><b>3</b> Introduction to the tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#setup-intructions"><i class="fa fa-check"></i><b>3.1.1</b> Setup intructions</a></li>
<li class="chapter" data-level="3.1.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#background"><i class="fa fa-check"></i><b>3.1.2</b> Background</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#data-description"><i class="fa fa-check"></i><b>3.2</b> Data description</a></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#getting-started"><i class="fa fa-check"></i><b>3.3</b> Getting Started</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#making-an-rstudio-project"><i class="fa fa-check"></i><b>3.3.1</b> Making an RStudio project</a></li>
<li class="chapter" data-level="3.3.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#installing-and-loading-packages-1"><i class="fa fa-check"></i><b>3.3.2</b> Installing and loading packages</a></li>
<li class="chapter" data-level="3.3.3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#downloading-the-data"><i class="fa fa-check"></i><b>3.3.3</b> Downloading the data</a></li>
<li class="chapter" data-level="3.3.4" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#loading-data-with-readr"><i class="fa fa-check"></i><b>3.3.4</b> Loading data with <code>readr</code></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#data-in-r"><i class="fa fa-check"></i><b>3.4</b> Data in R</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#basic-data-types-in-r"><i class="fa fa-check"></i><b>3.4.1</b> Basic data types in R</a></li>
<li class="chapter" data-level="3.4.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#basic-data-structures-in-r"><i class="fa fa-check"></i><b>3.4.2</b> Basic data structures in R</a></li>
<li class="chapter" data-level="3.4.3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#conditional-statements-and-logical-operators"><i class="fa fa-check"></i><b>3.4.3</b> Conditional statements and logical operators</a></li>
<li class="chapter" data-level="3.4.4" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#exercises-1"><i class="fa fa-check"></i><b>3.4.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#data-wrangling-with-dplyr"><i class="fa fa-check"></i><b>3.5</b> Data wrangling with <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#select"><i class="fa fa-check"></i><b>3.5.1</b> Select</a></li>
<li class="chapter" data-level="3.5.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#filter"><i class="fa fa-check"></i><b>3.5.2</b> Filter</a></li>
<li class="chapter" data-level="3.5.3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#rename"><i class="fa fa-check"></i><b>3.5.3</b> Rename</a></li>
<li class="chapter" data-level="3.5.4" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#arrange"><i class="fa fa-check"></i><b>3.5.4</b> Arrange</a></li>
<li class="chapter" data-level="3.5.5" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#mutate"><i class="fa fa-check"></i><b>3.5.5</b> Mutate</a></li>
<li class="chapter" data-level="3.5.6" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#piping-with"><i class="fa fa-check"></i><b>3.5.6</b> Piping with <code>%&gt;%</code></a></li>
<li class="chapter" data-level="3.5.7" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#group-by-and-summarise"><i class="fa fa-check"></i><b>3.5.7</b> Group by and Summarise</a></li>
<li class="chapter" data-level="3.5.8" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#wide-and-long-data---gather-and-spread"><i class="fa fa-check"></i><b>3.5.8</b> Wide and long data - gather and spread</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#graphics-with-ggplot2"><i class="fa fa-check"></i><b>3.6</b> Graphics with ggplot2</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#why-ggolot"><i class="fa fa-check"></i><b>3.6.1</b> Why ggolot?</a></li>
<li class="chapter" data-level="3.6.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#ggplot-building-blocks"><i class="fa fa-check"></i><b>3.6.2</b> ggplot building blocks</a></li>
<li class="chapter" data-level="3.6.3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#geom_point"><i class="fa fa-check"></i><b>3.6.3</b> geom_point</a></li>
<li class="chapter" data-level="3.6.4" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#geom_line"><i class="fa fa-check"></i><b>3.6.4</b> geom_line</a></li>
<li class="chapter" data-level="3.6.5" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#geom_histogram"><i class="fa fa-check"></i><b>3.6.5</b> geom_histogram</a></li>
<li class="chapter" data-level="3.6.6" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#geom_boxplot"><i class="fa fa-check"></i><b>3.6.6</b> geom_boxplot</a></li>
<li class="chapter" data-level="3.6.7" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#facet_wrap"><i class="fa fa-check"></i><b>3.6.7</b> facet_wrap</a></li>
<li class="chapter" data-level="3.6.8" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#labels"><i class="fa fa-check"></i><b>3.6.8</b> labels</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#fine-tuning-your-ggplots"><i class="fa fa-check"></i><b>3.7</b> Fine-tuning your ggplots</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#themes"><i class="fa fa-check"></i><b>3.7.1</b> Themes</a></li>
<li class="chapter" data-level="3.7.2" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#panel-1"><i class="fa fa-check"></i><b>3.7.2</b> Panel 1</a></li>
<li class="chapter" data-level="3.7.3" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#panel-2"><i class="fa fa-check"></i><b>3.7.3</b> Panel 2</a></li>
<li class="chapter" data-level="3.7.4" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#multi-panel-figues"><i class="fa fa-check"></i><b>3.7.4</b> Multi-panel figues</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#saving-ggplots"><i class="fa fa-check"></i><b>3.8</b> Saving ggplots</a></li>
<li class="chapter" data-level="3.9" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#additional-resources"><i class="fa fa-check"></i><b>3.9</b> Additional resources</a></li>
<li class="chapter" data-level="3.10" data-path="introduction-to-the-tidyverse-1.html"><a href="introduction-to-the-tidyverse-1.html#survey-1"><i class="fa fa-check"></i><b>3.10</b> Survey</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html"><i class="fa fa-check"></i><b>4</b> Reproducible research</a>
<ul>
<li class="chapter" data-level="4.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#prior-to-the-workshop"><i class="fa fa-check"></i><b>4.2</b> Prior to the workshop</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#setup-instructions"><i class="fa fa-check"></i><b>4.2.1</b> Setup instructions</a></li>
<li class="chapter" data-level="4.2.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#background-1"><i class="fa fa-check"></i><b>4.2.2</b> Background</a></li>
<li class="chapter" data-level="4.2.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#terminology"><i class="fa fa-check"></i><b>4.2.3</b> Terminology</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#why-reproducibility"><i class="fa fa-check"></i><b>4.3</b> Why reproducibility?</a></li>
<li class="chapter" data-level="4.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#r-projects"><i class="fa fa-check"></i><b>4.4</b> R projects</a></li>
<li class="chapter" data-level="4.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#r-scripts"><i class="fa fa-check"></i><b>4.5</b> R scripts</a></li>
<li class="chapter" data-level="4.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#modularize-by-task"><i class="fa fa-check"></i><b>4.6</b> Modularize by task</a></li>
<li class="chapter" data-level="4.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#use-make"><i class="fa fa-check"></i><b>4.7</b> Use <em>Make</em></a></li>
<li class="chapter" data-level="4.8" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#reproducible-r-environment-with-packrat"><i class="fa fa-check"></i><b>4.8</b> Reproducible R environment with <code>packrat</code></a></li>
<li class="chapter" data-level="4.9" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#documents-made-reproducible"><i class="fa fa-check"></i><b>4.9</b> Documents made reproducible</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#what-is-a-document-really"><i class="fa fa-check"></i><b>4.9.1</b> What is a document really?</a></li>
<li class="chapter" data-level="4.9.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#rmarkdown"><i class="fa fa-check"></i><b>4.9.2</b> Rmarkdown</a></li>
<li class="chapter" data-level="4.9.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#knitting"><i class="fa fa-check"></i><b>4.9.3</b> Knitting</a></li>
<li class="chapter" data-level="4.9.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#markdown-body"><i class="fa fa-check"></i><b>4.9.4</b> Markdown body</a></li>
<li class="chapter" data-level="4.9.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#static-documents"><i class="fa fa-check"></i><b>4.9.5</b> Static documents</a></li>
<li class="chapter" data-level="4.9.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#dynamic-documents"><i class="fa fa-check"></i><b>4.9.6</b> Dynamic documents</a></li>
<li class="chapter" data-level="4.9.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#slides-made-reproducible"><i class="fa fa-check"></i><b>4.9.7</b> Slides made reproducible</a></li>
<li class="chapter" data-level="4.9.8" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#rmd-in-your-workflow"><i class="fa fa-check"></i><b>4.9.8</b> Rmd in your workflow</a></li>
<li class="chapter" data-level="4.9.9" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#publish-with-rpubs.com"><i class="fa fa-check"></i><b>4.9.9</b> Publish with Rpubs.com</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#git"><i class="fa fa-check"></i><b>4.10</b> Git</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#what-is-version-control"><i class="fa fa-check"></i><b>4.10.1</b> What is version control?</a></li>
<li class="chapter" data-level="4.10.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#why-git"><i class="fa fa-check"></i><b>4.10.2</b> Why Git?</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#git-on-your-computer"><i class="fa fa-check"></i><b>4.11</b> Git on your computer</a>
<ul>
<li class="chapter" data-level="4.11.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#initialize-a-repo-git-init"><i class="fa fa-check"></i><b>4.11.1</b> Initialize a repo (<code>git init</code>)</a></li>
<li class="chapter" data-level="4.11.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#add-files-git-add"><i class="fa fa-check"></i><b>4.11.2</b> Add files (<code>git add</code>)</a></li>
<li class="chapter" data-level="4.11.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#git-staging-area-index"><i class="fa fa-check"></i><b>4.11.3</b> Git staging area (index)</a></li>
<li class="chapter" data-level="4.11.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#commit-changes-git-commit"><i class="fa fa-check"></i><b>4.11.4</b> Commit changes (<code>git commit</code>)</a></li>
<li class="chapter" data-level="4.11.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#comapre-versions-git-status-and-diff"><i class="fa fa-check"></i><b>4.11.5</b> Comapre versions (<code>git status</code> and <code>diff</code>)</a></li>
<li class="chapter" data-level="4.11.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#past-commits-git-log-and-show"><i class="fa fa-check"></i><b>4.11.6</b> Past commits (<code>git log</code> and <code>show</code>)</a></li>
<li class="chapter" data-level="4.11.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#branches-git-checkout--b"><i class="fa fa-check"></i><b>4.11.7</b> Branches (<code>git checkout -b</code>)</a></li>
<li class="chapter" data-level="4.11.8" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#merge-conflicts-git-merge"><i class="fa fa-check"></i><b>4.11.8</b> Merge conflicts (<code>git merge</code>)</a></li>
<li class="chapter" data-level="4.11.9" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#summary-of-git"><i class="fa fa-check"></i><b>4.11.9</b> Summary of Git</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#collaborate-with-github"><i class="fa fa-check"></i><b>4.12</b> Collaborate with GitHub</a>
<ul>
<li class="chapter" data-level="4.12.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#configure-your-computer-git-config"><i class="fa fa-check"></i><b>4.12.1</b> Configure your computer (<code>git config</code>)</a></li>
<li class="chapter" data-level="4.12.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#make-an-online-repo"><i class="fa fa-check"></i><b>4.12.2</b> Make an online repo</a></li>
<li class="chapter" data-level="4.12.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#link-local-and-online-repo-git-remote"><i class="fa fa-check"></i><b>4.12.3</b> Link local and online repo (<code>git remote</code>)</a></li>
<li class="chapter" data-level="4.12.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#update-an-online-repo-git-push"><i class="fa fa-check"></i><b>4.12.4</b> Update an online repo (<code>git push</code>)</a></li>
<li class="chapter" data-level="4.12.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#copy-an-online-repo-git-clone"><i class="fa fa-check"></i><b>4.12.5</b> Copy an online repo (<code>git clone</code>)</a></li>
<li class="chapter" data-level="4.12.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#update-from-online-repo-git-fetch-and-pull"><i class="fa fa-check"></i><b>4.12.6</b> Update from online repo (<code>git fetch</code> and <code>pull</code>)</a></li>
<li class="chapter" data-level="4.12.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#github-gui"><i class="fa fa-check"></i><b>4.12.7</b> GitHub GUI</a></li>
<li class="chapter" data-level="4.12.8" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#git-in-rstudio"><i class="fa fa-check"></i><b>4.12.8</b> Git in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#additional-resources-1"><i class="fa fa-check"></i><b>4.13</b> Additional resources</a>
<ul>
<li class="chapter" data-level="4.13.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#reproducible-research-2"><i class="fa fa-check"></i><b>4.13.1</b> Reproducible research</a></li>
<li class="chapter" data-level="4.13.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#rrstudio"><i class="fa fa-check"></i><b>4.13.2</b> R/RStudio</a></li>
<li class="chapter" data-level="4.13.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#gitgithub"><i class="fa fa-check"></i><b>4.13.3</b> Git/GitHub</a></li>
</ul></li>
<li class="chapter" data-level="4.14" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#survey-2"><i class="fa fa-check"></i><b>4.14</b> Survey</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html"><i class="fa fa-check"></i><b>5</b> Statistical models in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#setup-instructions-1"><i class="fa fa-check"></i><b>5.1.1</b> Setup instructions</a></li>
<li class="chapter" data-level="5.1.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#data-description-1"><i class="fa fa-check"></i><b>5.1.2</b> Data description</a></li>
<li class="chapter" data-level="5.1.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#making-an-rstudio-project-1"><i class="fa fa-check"></i><b>5.1.3</b> Making an RStudio project</a></li>
<li class="chapter" data-level="5.1.4" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#installing-and-loading-packages-2"><i class="fa fa-check"></i><b>5.1.4</b> Installing and loading packages</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#experimental-design"><i class="fa fa-check"></i><b>5.2</b> Experimental design</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#balanced-designs"><i class="fa fa-check"></i><b>5.2.1</b> Balanced designs</a></li>
<li class="chapter" data-level="5.2.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#blocking-factors-and-random-effects"><i class="fa fa-check"></i><b>5.2.2</b> Blocking factors and random effects</a></li>
<li class="chapter" data-level="5.2.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#randomization"><i class="fa fa-check"></i><b>5.2.3</b> Randomization</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.3</b> Analysis of Variance (ANOVA)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#key-assumptions"><i class="fa fa-check"></i><b>5.3.1</b> Key assumptions</a></li>
<li class="chapter" data-level="5.3.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#the-gist-of-the-math"><i class="fa fa-check"></i><b>5.3.2</b> The gist of the math</a></li>
<li class="chapter" data-level="5.3.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#way-anova-with-2-groups"><i class="fa fa-check"></i><b>5.3.3</b> 1-way ANOVA with 2 groups</a></li>
<li class="chapter" data-level="5.3.4" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#formula-notation-in-r"><i class="fa fa-check"></i><b>5.3.4</b> Formula notation in R</a></li>
<li class="chapter" data-level="5.3.5" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#anova-in-r"><i class="fa fa-check"></i><b>5.3.5</b> ANOVA in R</a></li>
<li class="chapter" data-level="5.3.6" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#way-anova-with-2-groups-1"><i class="fa fa-check"></i><b>5.3.6</b> 1-way ANOVA with &gt; 2 groups</a></li>
<li class="chapter" data-level="5.3.7" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#reload-and-explore-the-data"><i class="fa fa-check"></i><b>5.3.7</b> Reload and explore the data</a></li>
<li class="chapter" data-level="5.3.8" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#assess-which-groups-differ"><i class="fa fa-check"></i><b>5.3.8</b> Assess which groups differ</a></li>
<li class="chapter" data-level="5.3.9" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#way-anova-with-2-groups-2"><i class="fa fa-check"></i><b>5.3.9</b> 2-way ANOVA with 2 groups</a></li>
<li class="chapter" data-level="5.3.10" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#way-anova-with-2-groups-including-an-interaction-term"><i class="fa fa-check"></i><b>5.3.10</b> 2-way ANOVA with 2 groups including an interaction term</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#linear-regression"><i class="fa fa-check"></i><b>5.4</b> Linear regression</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#load-and-explore-the-data-1"><i class="fa fa-check"></i><b>5.4.1</b> Load and explore the data</a></li>
<li class="chapter" data-level="5.4.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#linear-models"><i class="fa fa-check"></i><b>5.4.2</b> Linear models</a></li>
<li class="chapter" data-level="5.4.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#key-assumptions-1"><i class="fa fa-check"></i><b>5.4.3</b> Key assumptions</a></li>
<li class="chapter" data-level="5.4.4" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#simple-linear-regression"><i class="fa fa-check"></i><b>5.4.4</b> Simple linear regression</a></li>
<li class="chapter" data-level="5.4.5" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#residuals"><i class="fa fa-check"></i><b>5.4.5</b> Residuals</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#cautions-when-using-linear-models"><i class="fa fa-check"></i><b>5.5</b> Cautions when using linear models</a></li>
<li class="chapter" data-level="5.6" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.6</b> Multiple linear regression</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#multiple-is-the-formula-not-the-predictor"><i class="fa fa-check"></i><b>5.6.1</b> Multiple is the formula, not the predictor</a></li>
<li class="chapter" data-level="5.6.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#transforming-predictors-log"><i class="fa fa-check"></i><b>5.6.2</b> Transforming predictors: log</a></li>
<li class="chapter" data-level="5.6.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#transforming-predictors-polynomial"><i class="fa fa-check"></i><b>5.6.3</b> Transforming predictors: polynomial</a></li>
<li class="chapter" data-level="5.6.4" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#interactions-and-analysis-of-covarianvce-ancova"><i class="fa fa-check"></i><b>5.6.4</b> Interactions and ANalysis of COVArianvce (ANCOVA)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#linear-mixed-effects-models"><i class="fa fa-check"></i><b>5.7</b> Linear Mixed Effects models</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#motivations-for-lme"><i class="fa fa-check"></i><b>5.7.1</b> Motivations for LME</a></li>
<li class="chapter" data-level="5.7.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#definitions"><i class="fa fa-check"></i><b>5.7.2</b> Definitions</a></li>
<li class="chapter" data-level="5.7.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#fitting-lme"><i class="fa fa-check"></i><b>5.7.3</b> Fitting LME</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#generalized-linear-models"><i class="fa fa-check"></i><b>5.8</b> Generalized Linear models</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#definition"><i class="fa fa-check"></i><b>5.8.1</b> Definition</a></li>
<li class="chapter" data-level="5.8.2" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#fitting-glms"><i class="fa fa-check"></i><b>5.8.2</b> Fitting GLMs</a></li>
<li class="chapter" data-level="5.8.3" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#logistic-regression-family-binomial"><i class="fa fa-check"></i><b>5.8.3</b> Logistic regression (<code>family = binomial</code>)</a></li>
<li class="chapter" data-level="5.8.4" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#count-data-family-poisson"><i class="fa fa-check"></i><b>5.8.4</b> Count data (<code>family = poisson</code>)</a></li>
<li class="chapter" data-level="5.8.5" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#negative-binomial-model-for-count-data"><i class="fa fa-check"></i><b>5.8.5</b> Negative binomial model for count data</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="statistical-models-in-r-1.html"><a href="statistical-models-in-r-1.html#survey-3"><i class="fa fa-check"></i><b>5.9</b> Survey</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html"><i class="fa fa-check"></i><b>6</b> Intermediate R programming</a>
<ul>
<li class="chapter" data-level="6.1" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#setup-instructions-2"><i class="fa fa-check"></i><b>6.1.1</b> Setup instructions</a></li>
<li class="chapter" data-level="6.1.2" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#background-2"><i class="fa fa-check"></i><b>6.1.2</b> Background</a></li>
<li class="chapter" data-level="6.1.3" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#data-description-2"><i class="fa fa-check"></i><b>6.1.3</b> Data description</a></li>
<li class="chapter" data-level="6.1.4" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#making-an-rstudio-project-2"><i class="fa fa-check"></i><b>6.1.4</b> Making an RStudio project</a></li>
<li class="chapter" data-level="6.1.5" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#installing-and-loading-packages-3"><i class="fa fa-check"></i><b>6.1.5</b> Installing and loading packages</a></li>
<li class="chapter" data-level="6.1.6" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#downloading-data"><i class="fa fa-check"></i><b>6.1.6</b> Downloading data</a></li>
<li class="chapter" data-level="6.1.7" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#load-data"><i class="fa fa-check"></i><b>6.1.7</b> Load data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#objects-classes-and-attributes"><i class="fa fa-check"></i><b>6.2</b> Objects, classes, and attributes</a></li>
<li class="chapter" data-level="6.3" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#s3-objects"><i class="fa fa-check"></i><b>6.3</b> S3 objects</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#vectors-1"><i class="fa fa-check"></i><b>6.3.1</b> Vectors</a></li>
<li class="chapter" data-level="6.3.2" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#complex-objects"><i class="fa fa-check"></i><b>6.3.2</b> Complex objects</a></li>
<li class="chapter" data-level="6.3.3" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#data-objects"><i class="fa fa-check"></i><b>6.3.3</b> Data objects</a></li>
<li class="chapter" data-level="6.3.4" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#the-r-list-object"><i class="fa fa-check"></i><b>6.3.4</b> The R list object</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#s4-objects"><i class="fa fa-check"></i><b>6.4</b> S4 objects</a></li>
<li class="chapter" data-level="6.5" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#functions-1"><i class="fa fa-check"></i><b>6.5</b> Functions</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#basics"><i class="fa fa-check"></i><b>6.5.1</b> Basics</a></li>
<li class="chapter" data-level="6.5.2" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#arguments"><i class="fa fa-check"></i><b>6.5.2</b> Arguments</a></li>
<li class="chapter" data-level="6.5.3" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#triple-dot-argument"><i class="fa fa-check"></i><b>6.5.3</b> Triple-dot argument</a></li>
<li class="chapter" data-level="6.5.4" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#scoping"><i class="fa fa-check"></i><b>6.5.4</b> Scoping</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#building-a-function"><i class="fa fa-check"></i><b>6.6</b> Building a function</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-1.-define-and-test-your-task"><i class="fa fa-check"></i><b>6.6.1</b> Step 1. Define and test your task</a></li>
<li class="chapter" data-level="6.6.2" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-3-add-packages"><i class="fa fa-check"></i><b>6.6.2</b> Step 3: Add packages</a></li>
<li class="chapter" data-level="6.6.3" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-4-start-you-r-documentation"><i class="fa fa-check"></i><b>6.6.3</b> Step 4: Start you r documentation</a></li>
<li class="chapter" data-level="6.6.4" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-5-loop-through-multiple-y-variables"><i class="fa fa-check"></i><b>6.6.4</b> Step 5: Loop through multiple y-variables</a></li>
<li class="chapter" data-level="6.6.5" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-6-save-results-to-a-table"><i class="fa fa-check"></i><b>6.6.5</b> Step 6: Save results to a table</a></li>
<li class="chapter" data-level="6.6.6" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-6.1-save-all-iterations-of-the-loop"><i class="fa fa-check"></i><b>6.6.6</b> Step 6.1: Save all iterations of the loop</a></li>
<li class="chapter" data-level="6.6.7" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-6.2-beautify-the-output"><i class="fa fa-check"></i><b>6.6.7</b> Step 6.2 Beautify the output</a></li>
<li class="chapter" data-level="6.6.8" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#step-7-complete-documentation"><i class="fa fa-check"></i><b>6.6.8</b> Step 7: Complete documentation</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#packages"><i class="fa fa-check"></i><b>6.7</b> Packages</a></li>
<li class="chapter" data-level="6.8" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#creating-a-package-project"><i class="fa fa-check"></i><b>6.8</b> Creating a package project</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#description"><i class="fa fa-check"></i><b>6.8.1</b> Description</a></li>
<li class="chapter" data-level="6.8.2" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#r"><i class="fa fa-check"></i><b>6.8.2</b> R/</a></li>
<li class="chapter" data-level="6.8.3" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#man"><i class="fa fa-check"></i><b>6.8.3</b> man/</a></li>
<li class="chapter" data-level="6.8.4" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#namespace"><i class="fa fa-check"></i><b>6.8.4</b> Namespace</a></li>
<li class="chapter" data-level="6.8.5" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#adding-imports-and-exports"><i class="fa fa-check"></i><b>6.8.5</b> Adding imports and exports</a></li>
<li class="chapter" data-level="6.8.6" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#test-your-package"><i class="fa fa-check"></i><b>6.8.6</b> Test your package</a></li>
<li class="chapter" data-level="6.8.7" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#test-your-package-again"><i class="fa fa-check"></i><b>6.8.7</b> Test your package again</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#further-resources"><i class="fa fa-check"></i><b>6.9</b> Further resources</a></li>
<li class="chapter" data-level="6.10" data-path="intermediate-r-programming-1.html"><a href="intermediate-r-programming-1.html#survey-4"><i class="fa fa-check"></i><b>6.10</b> Survey</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ECOSCOPE: Data Science Workshops</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-models-in-r-1" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Statistical models in R</h1>
<div id="introduction-3" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>In this workshop, we introduce various types of regression models and how they are implemented in R. We cover linear regression, ANOVA, ANCOVA, and mixed effects models for continuous response data, logistic regression binary response data, as well as Poisson and Negative Binomial regression for count response data.</p>
<p>You will learn:</p>
<ul>
<li>the different functions used to build a statistical model in R,</li>
<li>the assumptions behind the different models,</li>
<li>how the formula object in R is used to specify all the model terms,</li>
<li>how to interpret the main effects and interaction terms in a model,</li>
<li>various experimental design concepts that help maximize power.</li>
</ul>
<p>This is an intermediate workshop series that assumes prior R experience including RStudio projects and the R <a href="https://www.tidyverse.org/">tidyverse</a>.</p>
<div id="setup-instructions-1" class="section level3" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Setup instructions</h3>
<p>Please come to the workshop with your laptop setup with the required
software and data files as described in our <a href="setup/stats_models_setup.html">setup instructions</a>.</p>
</div>
<div id="data-description-1" class="section level3" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Data description</h3>
<p>Unlike our other workshops, ‘Statistical Models’ utilizes several data sets in order to accurately demonstrate the use of statistical tests. You will find more information on each of these data sets in its relevant section(s) within the notes below.</p>
</div>
<div id="making-an-rstudio-project-1" class="section level3" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Making an RStudio project</h3>
<p>Projects allow you to divide your work into self-contained contexts.</p>
<p>Let’s create a project to work in.</p>
<p>In the top-right corner of your RStudio window, click the “Project: (None)” button to show the projects drop-down menu. Select “New Project…” &gt; “New Directory” &gt; “New Project.” Under directory name, input “statistical_models” and choose a parent directory to contain this project on your computer.</p>
</div>
<div id="installing-and-loading-packages-2" class="section level3" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Installing and loading packages</h3>
<p>At the beginning of every R script, you should have a dedicated space for loading R packages. R packages allow any R user to code reproducible functions and share them with the R community. Packages exist for anything ranging from microbial ecology to complex graphics to multivariate modeling and beyond.</p>
<p>In this workshop, we will use many different packages. Here, we load the necessary packages which <em>must already be installed</em> (see <a href="setup/stats_models_setup.html">setup instructions</a> for details).</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="statistical-models-in-r-1.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># Easily Install and Load the &#39;Tidyverse&#39;</span></span>
<span id="cb221-2"><a href="statistical-models-in-r-1.html#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) <span class="co"># Convert Statistical Objects into Tidy Tibbles</span></span>
<span id="cb221-3"><a href="statistical-models-in-r-1.html#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broomExtra) <span class="co"># Enhancements for &#39;broom&#39; and &#39;easystats&#39; Package Families</span></span>
<span id="cb221-4"><a href="statistical-models-in-r-1.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr) <span class="co"># Tools for Splitting, Applying and Combining Data</span></span>
<span id="cb221-5"><a href="statistical-models-in-r-1.html#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4) <span class="co"># Linear Mixed-Effects Models using &#39;Eigen&#39; and S4</span></span>
<span id="cb221-6"><a href="statistical-models-in-r-1.html#cb221-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># Companion to Applied Regression </span></span>
<span id="cb221-7"><a href="statistical-models-in-r-1.html#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lsmeans) <span class="co"># Least-Squares Means</span></span>
<span id="cb221-8"><a href="statistical-models-in-r-1.html#cb221-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># Support Functions and Datasets for Venables and Ripley&#39;s MASS</span></span>
<span id="cb221-9"><a href="statistical-models-in-r-1.html#cb221-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faraway) <span class="co"># Functions and Datasets for Books by Julian Faraway</span></span>
<span id="cb221-10"><a href="statistical-models-in-r-1.html#cb221-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gapminder) <span class="co"># Data from Gapminder  </span></span>
<span id="cb221-11"><a href="statistical-models-in-r-1.html#cb221-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HSAUR3) <span class="co"># A Handbook of Statistical Analyses Using R (3rd Edition) </span></span></code></pre></div>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="statistical-models-in-r-1.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set global plot theme</span></span>
<span id="cb222-2"><a href="statistical-models-in-r-1.html#cb222-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_classic</span>())</span></code></pre></div>
</div>
</div>
<div id="experimental-design" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Experimental design</h2>
<div id="balanced-designs" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Balanced designs</h3>
<ul>
<li>A balanced design has equal (or roughly equal) number of observations for each group</li>
<li>Balance eliminates confounding factors and increases power</li>
</ul>
</div>
<div id="blocking-factors-and-random-effects" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Blocking factors and random effects</h3>
<ul>
<li>Blocking factors and random effects should be used/recorded to control sources of variation that exist but are otherwise not of interest</li>
</ul>
</div>
<div id="randomization" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Randomization</h3>
<ul>
<li>Subjects should be randomized to groups to help balance the unobserved factors in the
experiment.</li>
<li>Randomization should be done in a way to keep the controlled and observational factors (blocking factors and random effects) balanced.</li>
</ul>
</div>
</div>
<div id="analysis-of-variance-anova" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Analysis of Variance (ANOVA)</h2>
<p>ANOVA is used when you have data with:</p>
<ul>
<li>a quantitative response/dependent variable (<span class="math inline">\(Y\)</span>) such as:
<ul>
<li>height</li>
<li>salary</li>
<li>number of offspring</li>
</ul></li>
<li>one or more categorical explanatory/independent variable(s) (<span class="math inline">\(X\)</span>’s) such as:
<ul>
<li>eye color</li>
<li>sex</li>
<li>genotype at a given locus</li>
</ul></li>
</ul>
<p>For example, you would use ANOVA to address questions like:</p>
<ol style="list-style-type: decimal">
<li>Does diet has an effect on weight gain?
<ul>
<li>response variable = weight gain (<em>e.g.</em> kg)</li>
<li>explanatory variable = type of diet (<em>e.g.</em> low vs. medium vs. high sugar)</li>
</ul></li>
<li>Does the type sexual relationship practiced influence the fitness of male Red-winged Blackbirds?
<ul>
<li>response variable = fitness of male bird (<em>e.g.</em> # eggs laid)</li>
<li>explanatory variable = sexual relationship (<em>e.g.</em> monagamy vs. polygamy)</li>
</ul></li>
</ol>
<div id="key-assumptions" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Key assumptions</h3>
<ul>
<li>ANOVA is robust to the non-normality of sample data</li>
<li>Balanced ANOVA (equal sample size between groups) is robust to unequal variance</li>
<li>ANOVA is sensitive to sample independence</li>
</ul>
</div>
<div id="the-gist-of-the-math" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> The gist of the math</h3>
<p>When we run an ANOVA on these data, we calculate a test statistic (F-statistic) that compares the <strong>between</strong> group variation with the <strong>within</strong> group variation.</p>
<p><span class="math display">\[F = MSB/MSW\]</span></p>
<p>where <span class="math inline">\(MSB\)</span> = Mean Square Between and <span class="math inline">\(MSW\)</span> = Mean Square Within</p>
<p>Essentially, if there is greater variation between the groups than within the groups we will get a large test statistic value (and correspondingly, a small p-value) and reject that null hypothesis (<span class="math inline">\(H_0\)</span>: population means of all groups are equal).</p>
<p>If you want to delve into ANOVA in more depth, checkout <a href="https://www.khanacademy.org/math/statistics-probability/analysis-of-variance-anova-library">this video tutorial</a>.</p>
</div>
<div id="way-anova-with-2-groups" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> 1-way ANOVA with 2 groups</h3>
<p>Now let’s run some ANOVAs on real data!</p>
<p>There are two perfectly acceptable statistical tests in R that we could apply to compare data in 2 groups. The first, which you may be very familiar with, is the <em>t</em>-test. The second is the topic of our lesson today, Analysis of Variance (or ANOVA). Interestingly, the <em>t</em>-test is really a special case of ANOVA that can be used when only comparing 2 groups. ANOVA is a more generalizable test that we will later see can be used with &gt; 2 groups as well as more than one factor/category column.</p>
<div id="load-and-explore-the-data" class="section level4" number="5.3.3.1">
<h4><span class="header-section-number">5.3.3.1</span> Load and explore the data</h4>
<p>The first experiment we are going to analyze was done to address the question of whether sexual activity effects the longevity of male fruit flies. To assess this, we are going to use a modified version of the <code>fruitfly</code> data from the <a href="https://cran.r-project.org/web/packages/faraway/faraway.pdf"><code>faraway</code> R package</a>.</p>
<p>Our hypothesis for this experiment are as follows:</p>
<p><strong>Null Hypothesis, <span class="math inline">\(H_{0}\)</span></strong>: Sexual activity has no effect on the population mean longevity of male fruit flies.<br />
<strong>Alternative Hypothesis, <span class="math inline">\(H_{A}\)</span></strong>: Sexual activity has an effect on population mean longevity of male fruit flies.</p>
<p>Let’s now load the fruit fly data from the <code>faraway</code> package, and create our categorical groups from the numerical variables. <em>If you are unfamiliar with the functions below, checkout our <a href="https://github.com/EDUCE-UBC/workshops_R/tree/main/intro_tidyverse">R tidyverse workshop</a>.</em></p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="statistical-models-in-r-1.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read in the data from faraway package</span></span>
<span id="cb223-2"><a href="statistical-models-in-r-1.html#cb223-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;fruitfly&quot;</span>)</span>
<span id="cb223-3"><a href="statistical-models-in-r-1.html#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="statistical-models-in-r-1.html#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create categorical groups and subset data</span></span>
<span id="cb223-5"><a href="statistical-models-in-r-1.html#cb223-5" aria-hidden="true" tabindex="-1"></a>fruitfly_2groups <span class="ot">&lt;-</span> fruitfly <span class="sc">%&gt;%</span></span>
<span id="cb223-6"><a href="statistical-models-in-r-1.html#cb223-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert factors to character variables</span></span>
<span id="cb223-7"><a href="statistical-models-in-r-1.html#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.factor, as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb223-8"><a href="statistical-models-in-r-1.html#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create 2-level activity variable</span></span>
<span id="cb223-9"><a href="statistical-models-in-r-1.html#cb223-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">activity =</span> <span class="fu">ifelse</span>(activity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;isolated&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;many&quot;</span>), <span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb223-10"><a href="statistical-models-in-r-1.html#cb223-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create 2-level size variable (for later ANOVA)</span></span>
<span id="cb223-11"><a href="statistical-models-in-r-1.html#cb223-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">thorax =</span> <span class="fu">ifelse</span>(thorax <span class="sc">&lt;=</span> <span class="fl">0.8</span>, <span class="st">&quot;short&quot;</span>, <span class="st">&quot;long&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb223-12"><a href="statistical-models-in-r-1.html#cb223-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset to equal group sizes for activity and size</span></span>
<span id="cb223-13"><a href="statistical-models-in-r-1.html#cb223-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(activity, thorax) <span class="sc">%&gt;%</span> </span>
<span id="cb223-14"><a href="statistical-models-in-r-1.html#cb223-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">20</span>)</span></code></pre></div>
<p>When we explore these data (ignoring thorax data for now)…</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="statistical-models-in-r-1.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of rows and columns</span></span>
<span id="cb224-2"><a href="statistical-models-in-r-1.html#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fruitfly_2groups)</span></code></pre></div>
<pre><code>## [1] 80  3</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="statistical-models-in-r-1.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view first 6 records of data</span></span>
<span id="cb226-2"><a href="statistical-models-in-r-1.html#cb226-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fruitfly_2groups)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   activity, thorax [1]
##   thorax longevity activity
##   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;   
## 1 long          70 no      
## 2 long          72 no      
## 3 long          75 no      
## 4 long          81 no      
## 5 long          90 no      
## 6 long          96 no</code></pre>
<p>We see that there are 2 columns of interest, <code>longevity</code> and <code>activity</code>. <code>longevity</code> is a quantitative variable, and is our response/dependent variable for this experiment. <code>activity</code>, on the other hand, is a categorical variable, and is our single explanatory/independent variable for this experiment. There are 2 levels to the <code>activity</code> variable, <code>yes</code> and <code>no</code>.</p>
<p>Let’s visualize these data to get some intuition as to whether or not there is a difference in longevity between the male flies that are sexually active and those that are not.</p>
<p>Given that our sample sizes are not too large, the most informative plot we can make are strip plots. We will also add the mean to these:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="statistical-models-in-r-1.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raw data points for each group as a transparent grey/black point</span></span>
<span id="cb228-2"><a href="statistical-models-in-r-1.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># overlay mean as a red diamond</span></span>
<span id="cb228-3"><a href="statistical-models-in-r-1.html#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fruitfly_2groups, <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> longevity)) <span class="sc">+</span></span>
<span id="cb228-4"><a href="statistical-models-in-r-1.html#cb228-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>),</span>
<span id="cb228-5"><a href="statistical-models-in-r-1.html#cb228-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb228-6"><a href="statistical-models-in-r-1.html#cb228-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb228-7"><a href="statistical-models-in-r-1.html#cb228-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb228-8"><a href="statistical-models-in-r-1.html#cb228-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">18</span>,</span>
<span id="cb228-9"><a href="statistical-models-in-r-1.html#cb228-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb228-10"><a href="statistical-models-in-r-1.html#cb228-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb228-11"><a href="statistical-models-in-r-1.html#cb228-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sexually Active&quot;</span>) <span class="sc">+</span></span>
<span id="cb228-12"><a href="statistical-models-in-r-1.html#cb228-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Longevity (days)&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-100-1.png" width="480" /></p>
<p>We can see that there is a difference between the mean of these two <strong>samples</strong>, but what can we say/infer about the <strong>population</strong> means of these two groups? To say anything meaningful from a statistical standpoint, we need to perform a statistical test that will guide us in rejecting, or failing to reject, our null hypothesis (<em>i.e</em> Sexual activity has no effect on the population mean longevity of male fruit flies).</p>
</div>
</div>
<div id="formula-notation-in-r" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Formula notation in R</h3>
<p>To perform an ANOVA in R, we need to understand R’s formula notation, as this is the first argument we give to the ANOVA function (<code>aov</code>). The formula notation starts with providing the response variable, then a special character, <code>~</code>, which can be read as “modeled as,” and then the explanatory/independent variable(s). Thus, the formula notation for this experiment is:</p>
<pre><code>longevity ~ activity</code></pre>
<p>The formula notation can get more complex such as including additional explanatory/independent variables or interaction terms. We will introduce these are we attempt more complex analyses later on.</p>
</div>
<div id="anova-in-r" class="section level3" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> ANOVA in R</h3>
<p>To do an ANOVA in R, we will use the <code>aov</code> function. As stated above, the first argument to this is the formula for the experiment/model, and the second argument we must provide is the name of the variable holding our data, here <code>fruitfly_2groups</code>.</p>
<p>The <code>aov</code> function returns us a “model” object, and we need to use another function to see the results of the analysis. I suggest using the <code>tidy</code> function from the <a href="ftp://cran.r-project.org/pub/R/web/packages/broom/vignettes/broom.html"><code>broom</code> R package</a> as it returns the results in a nice data frame, that is easy to do further work with. Another, more traditional function to access these data is the <code>summary</code> function, but again, I don’t recommend this as accessing the individual numbers from the output of <code>aov</code> from this model is a bit trickier.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="statistical-models-in-r-1.html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an ANOVA &quot;model&quot; object</span></span>
<span id="cb230-2"><a href="statistical-models-in-r-1.html#cb230-2" aria-hidden="true" tabindex="-1"></a>fruitfly_2groups_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(longevity <span class="sc">~</span> activity,</span>
<span id="cb230-3"><a href="statistical-models-in-r-1.html#cb230-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> fruitfly_2groups)</span>
<span id="cb230-4"><a href="statistical-models-in-r-1.html#cb230-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-5"><a href="statistical-models-in-r-1.html#cb230-5" aria-hidden="true" tabindex="-1"></a><span class="co"># view output of aov() as a nice dataframe using tidy() from the broom package</span></span>
<span id="cb230-6"><a href="statistical-models-in-r-1.html#cb230-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fruitfly_2groups_model)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   term         df  sumsq meansq statistic    p.value
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1 activity      1  5729.  5729.      21.2  0.0000155
## 2 Residuals    78 21032.   270.      NA   NA</code></pre>
<p>So, what does this output mean? The most important result in regards to rejecting (or failing to reject) our null hypothesis is the p-value. In this simple one-way ANOVA, we have a single p-value which has a very small value of <span class="math inline">\(1.5515618\times 10^{-5}\)</span>. Given that this is much much smaller than the commonly used threshold for rejecting the null hypothesis, p &lt; 0.05, we can reject our null hypothesis that sexual activity has no effect on the population mean longevity of male fruit flies, and accept the alternative hypothesis that sexual activity <strong>does</strong> has an effect on population mean longevity of male fruit flies.</p>
<div id="exercise-1-way-anova" class="section level4" number="5.3.5.1">
<h4><span class="header-section-number">5.3.5.1</span> Exercise: 1-way ANOVA</h4>
<ol style="list-style-type: decimal">
<li>Using ANOVA, test if fruit fly longevity is effected bt size (as measured by thorax length). What are your null and alternative hypothesis? What can you conclude from these results?</li>
</ol>
</div>
</div>
<div id="way-anova-with-2-groups-1" class="section level3" number="5.3.6">
<h3><span class="header-section-number">5.3.6</span> 1-way ANOVA with &gt; 2 groups</h3>
<p>As mentioned at the start of this section, an ANOVA can be used when there are more than 2 levels in your categorical explanatory/independent variable (unlike a <em>t</em>-test). For example, we will consider the following case:</p>
<p>We are still interested in whether sexual activity effects the longevity of male fruit flies but want to understand this at a finer level (<em>e.g.</em> does the amount of sexual activity matter?). Thus, in this experiment, there are 3 categories for sexual <code>activity</code>. Specifically, males were kept:</p>
<ol style="list-style-type: decimal">
<li><code>none</code> - alone</li>
<li><code>low</code> - with a new virgin fruit fly every day</li>
<li><code>high</code> - with a new set of eight virgin fruit flies every day</li>
</ol>
<p>So, for this case, our hypotheses are as follows:</p>
<p><strong>Null Hypothesis, <span class="math inline">\(H_{0}\)</span></strong>: <span class="math inline">\(\mu_{isolated} = \mu_{low} = \mu_{high}\)</span><br />
<strong>Alternative Hypothesis, <span class="math inline">\(H_{A}\)</span></strong>: at least one group’s population mean differs from that of the other groups</p>
</div>
<div id="reload-and-explore-the-data" class="section level3" number="5.3.7">
<h3><span class="header-section-number">5.3.7</span> Reload and explore the data</h3>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="statistical-models-in-r-1.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create categorical groups and subset data</span></span>
<span id="cb232-2"><a href="statistical-models-in-r-1.html#cb232-2" aria-hidden="true" tabindex="-1"></a>fruitfly_3groups <span class="ot">&lt;-</span> fruitfly <span class="sc">%&gt;%</span></span>
<span id="cb232-3"><a href="statistical-models-in-r-1.html#cb232-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Convert factors to character variables</span></span>
<span id="cb232-4"><a href="statistical-models-in-r-1.html#cb232-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.factor, as.character) <span class="sc">%&gt;%</span> </span>
<span id="cb232-5"><a href="statistical-models-in-r-1.html#cb232-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create 3-level activity variable</span></span>
<span id="cb232-6"><a href="statistical-models-in-r-1.html#cb232-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">activity =</span> <span class="fu">ifelse</span>(activity <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;isolated&quot;</span>, <span class="st">&quot;one&quot;</span>, <span class="st">&quot;many&quot;</span>), <span class="st">&quot;none&quot;</span>, activity)) <span class="sc">%&gt;%</span></span>
<span id="cb232-7"><a href="statistical-models-in-r-1.html#cb232-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subset to equal group sizes for activity</span></span>
<span id="cb232-8"><a href="statistical-models-in-r-1.html#cb232-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(activity) <span class="sc">%&gt;%</span> </span>
<span id="cb232-9"><a href="statistical-models-in-r-1.html#cb232-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">25</span>)</span></code></pre></div>
<p>Let’s explore these data (again, ignore the thorax variable).</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="statistical-models-in-r-1.html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of rows and columns</span></span>
<span id="cb233-2"><a href="statistical-models-in-r-1.html#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fruitfly_3groups)</span></code></pre></div>
<pre><code>## [1] 75  3</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="statistical-models-in-r-1.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view first 6 records of data</span></span>
<span id="cb235-2"><a href="statistical-models-in-r-1.html#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fruitfly_3groups)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   activity [1]
##   thorax longevity activity
##    &lt;dbl&gt;     &lt;int&gt; &lt;chr&gt;   
## 1   0.64        19 high    
## 2   0.78        33 high    
## 3   0.88        54 high    
## 4   0.8         30 high    
## 5   0.88        47 high    
## 6   0.82        54 high</code></pre>
<p>And, again as a good practice, let’s visualize the data before we perform our statistical analysis.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="statistical-models-in-r-1.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># re-order factors to make them show up how we would like them on the plot</span></span>
<span id="cb237-2"><a href="statistical-models-in-r-1.html#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="co"># instead of alphabetically (default R behaviour)</span></span>
<span id="cb237-3"><a href="statistical-models-in-r-1.html#cb237-3" aria-hidden="true" tabindex="-1"></a>fruitfly_3groups<span class="sc">$</span>activity <span class="ot">&lt;-</span> <span class="fu">factor</span>(fruitfly_3groups<span class="sc">$</span>activity,</span>
<span id="cb237-4"><a href="statistical-models-in-r-1.html#cb237-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;none&quot;</span>,<span class="st">&quot;low&quot;</span>,<span class="st">&quot;high&quot;</span>))</span>
<span id="cb237-5"><a href="statistical-models-in-r-1.html#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot raw data points for each group as a transparent grey/black point</span></span>
<span id="cb237-6"><a href="statistical-models-in-r-1.html#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co"># overlay mean as a red diamond</span></span>
<span id="cb237-7"><a href="statistical-models-in-r-1.html#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fruitfly_3groups, <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> longevity)) <span class="sc">+</span></span>
<span id="cb237-8"><a href="statistical-models-in-r-1.html#cb237-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>),</span>
<span id="cb237-9"><a href="statistical-models-in-r-1.html#cb237-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb237-10"><a href="statistical-models-in-r-1.html#cb237-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb237-11"><a href="statistical-models-in-r-1.html#cb237-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb237-12"><a href="statistical-models-in-r-1.html#cb237-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">18</span>,</span>
<span id="cb237-13"><a href="statistical-models-in-r-1.html#cb237-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb237-14"><a href="statistical-models-in-r-1.html#cb237-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb237-15"><a href="statistical-models-in-r-1.html#cb237-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sexual Activity&quot;</span>) <span class="sc">+</span></span>
<span id="cb237-16"><a href="statistical-models-in-r-1.html#cb237-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Longevity (days)&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-103-1.png" width="480" /></p>
<p>So, it looks the sample means of longevity for both low and high activity are lower than the sample means of the isolated male fruit fly. Are these differences in the sample means indicating that there are differences in the true population means between any of these groups? Again we turn to ANOVA to answer this:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="statistical-models-in-r-1.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an ANOVA &quot;model&quot; object</span></span>
<span id="cb238-2"><a href="statistical-models-in-r-1.html#cb238-2" aria-hidden="true" tabindex="-1"></a>fruitfly_3groups_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(longevity <span class="sc">~</span> activity,</span>
<span id="cb238-3"><a href="statistical-models-in-r-1.html#cb238-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> fruitfly_3groups)</span>
<span id="cb238-4"><a href="statistical-models-in-r-1.html#cb238-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-5"><a href="statistical-models-in-r-1.html#cb238-5" aria-hidden="true" tabindex="-1"></a><span class="co"># view output of aov() as a nice dataframe using tidy() from the broom package</span></span>
<span id="cb238-6"><a href="statistical-models-in-r-1.html#cb238-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fruitfly_3groups_model)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 6
##   term         df  sumsq meansq statistic   p.value
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 activity      2 10123.  5061.      28.3  8.48e-10
## 2 Residuals    72 12872.   179.      NA   NA</code></pre>
<p>So, what does this output mean? Similar to a 1-way, 2 group ANOVA, we look at the p-value to determine if we reject (or fail to reject) our null hypothesis. In this case, we have a single p-value which has a very small value of <span class="math inline">\(8.4803266\times 10^{-10}\)</span>. Given that this is much much smaller than the commonly used threshold for rejecting the null hypothesis, p &lt; 0.05, we can reject our null hypothesis that all the population mean for longevity of male fruit flies is equal between all groups, and accept the alternative hypothesis that <strong>at least</strong> one group’s population mean differs from that of the other groups.</p>
<p>But which one(s) differ?</p>
</div>
<div id="assess-which-groups-differ" class="section level3" number="5.3.8">
<h3><span class="header-section-number">5.3.8</span> Assess which groups differ</h3>
<p>This is something ANOVA alone cannot tell us. To answer this, we need to either perform pair-wise <em>t</em>-tests (followed by an adjustment or correction for multiple comparisons, such as a Bonferroni correction, or False Discovery Rate) OR follow the ANOVA with a contrast-test, such as Tukey’s honestly significant difference (HSD) test. We’ll do both here, and show that we get similar results:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="statistical-models-in-r-1.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pairwise t-tests to observe group differences</span></span>
<span id="cb240-2"><a href="statistical-models-in-r-1.html#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">pairwise.t.test</span>(fruitfly_3groups<span class="sc">$</span>longevity,</span>
<span id="cb240-3"><a href="statistical-models-in-r-1.html#cb240-3" aria-hidden="true" tabindex="-1"></a>                fruitfly_3groups<span class="sc">$</span>activity,</span>
<span id="cb240-4"><a href="statistical-models-in-r-1.html#cb240-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">p.adjust.method =</span> <span class="st">&quot;bonferroni&quot;</span>,</span>
<span id="cb240-5"><a href="statistical-models-in-r-1.html#cb240-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">pool.sd =</span> <span class="cn">TRUE</span>,</span>
<span id="cb240-6"><a href="statistical-models-in-r-1.html#cb240-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">paired =</span> <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   group1 group2  p.value
##   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;
## 1 low    none   2.93e- 2
## 2 high   none   5.42e-10
## 3 high   low    2.81e- 5</code></pre>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="statistical-models-in-r-1.html#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tukey&#39;s HSD test to observe group differences</span></span>
<span id="cb242-2"><a href="statistical-models-in-r-1.html#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(<span class="fu">TukeyHSD</span>(fruitfly_3groups_model, <span class="st">&quot;activity&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 7
##   term     contrast  null.value estimate conf.low conf.high adj.p.value
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 activity low-none           0    -10.0    -19.1    -0.990    2.61e- 2
## 2 activity high-none          0    -28.1    -37.1   -19.0      4.56e-10
## 3 activity high-low           0    -18.0    -27.1    -8.99     2.76e- 5</code></pre>
<p>From both of these multiple comparison tests, we see that there is no significant difference between the population mean longevity of male fruit flies who had no or little sexual activity. However, high sexual activity does appear to matter, as the population mean longevity of male fruit flies who had high sexual activity is significantly different from that of male flies who had either no or low sexual activity.</p>
</div>
<div id="way-anova-with-2-groups-2" class="section level3" number="5.3.9">
<h3><span class="header-section-number">5.3.9</span> 2-way ANOVA with 2 groups</h3>
<p>Let’s continue to add complexity to our ANOVA model. In this experiment, we not only interested in how sexual activity might effect longevity; we are also interested in body size (assessed via thorax length). We do this because the literature indicates body size affects fruit fly longevity. Thus, now we have two categories/explanatory variables to look at sexual activity (back to our first version with levels <code>no</code> and <code>yes</code>) and thorax length (with levels <code>short</code> and <code>long</code>).</p>
<p>For this experiment, we have two sets of null and alternative hypotheses:</p>
<p><strong>Hypotheses for sexual activity</strong></p>
<p><strong>Null Hypothesis, <span class="math inline">\(H_{0}\)</span></strong>: <span class="math inline">\(\mu_{No} = \mu_{Yes}\)</span><br />
<strong>Alternative Hypothesis, <span class="math inline">\(H_{A}\)</span></strong>: <span class="math inline">\(\mu_{No} \ne \mu_{Yes}\)</span></p>
<p><strong>Hypotheses for thorax length</strong></p>
<p><strong>Null Hypothesis, <span class="math inline">\(H_{0}\)</span></strong>: <span class="math inline">\(\mu_{short} = \mu_{long}\)</span><br />
<strong>Alternative Hypothesis, <span class="math inline">\(H_{A}\)</span></strong>: <span class="math inline">\(\mu_{short} \ne \mu_{long}\)</span></p>
<p>Now that we have our case setup, let’s re-look at our 2 level data but now notice the thorax information.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="statistical-models-in-r-1.html#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get number of rows and columns</span></span>
<span id="cb244-2"><a href="statistical-models-in-r-1.html#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(fruitfly_2groups)</span></code></pre></div>
<pre><code>## [1] 80  3</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="statistical-models-in-r-1.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view first 6 records of data</span></span>
<span id="cb246-2"><a href="statistical-models-in-r-1.html#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fruitfly_2groups)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
## # Groups:   activity, thorax [1]
##   thorax longevity activity
##   &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;   
## 1 long          70 no      
## 2 long          72 no      
## 3 long          75 no      
## 4 long          81 no      
## 5 long          90 no      
## 6 long          96 no</code></pre>
<p>Next, let’s plot these data.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="statistical-models-in-r-1.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># re-order factors to make them show up how we would like them on the plot</span></span>
<span id="cb248-2"><a href="statistical-models-in-r-1.html#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="co"># instead of alphabetically (default R behaviour)</span></span>
<span id="cb248-3"><a href="statistical-models-in-r-1.html#cb248-3" aria-hidden="true" tabindex="-1"></a>fruitfly_2groups<span class="sc">$</span>thorax <span class="ot">&lt;-</span> <span class="fu">factor</span>(fruitfly_2groups<span class="sc">$</span>thorax,</span>
<span id="cb248-4"><a href="statistical-models-in-r-1.html#cb248-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;short&quot;</span>,<span class="st">&quot;long&quot;</span>))</span>
<span id="cb248-5"><a href="statistical-models-in-r-1.html#cb248-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot strip charts of longevity, grouped by sexual activity</span></span>
<span id="cb248-6"><a href="statistical-models-in-r-1.html#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and colored by thorax length</span></span>
<span id="cb248-7"><a href="statistical-models-in-r-1.html#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fruitfly_2groups,</span>
<span id="cb248-8"><a href="statistical-models-in-r-1.html#cb248-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> longevity, <span class="at">color =</span> thorax)) <span class="sc">+</span></span>
<span id="cb248-9"><a href="statistical-models-in-r-1.html#cb248-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb248-10"><a href="statistical-models-in-r-1.html#cb248-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb248-11"><a href="statistical-models-in-r-1.html#cb248-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">5</span>,</span>
<span id="cb248-12"><a href="statistical-models-in-r-1.html#cb248-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb248-13"><a href="statistical-models-in-r-1.html#cb248-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb248-14"><a href="statistical-models-in-r-1.html#cb248-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="fl">0.5</span>), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb248-15"><a href="statistical-models-in-r-1.html#cb248-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb248-16"><a href="statistical-models-in-r-1.html#cb248-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sexual Activity&quot;</span>) <span class="sc">+</span></span>
<span id="cb248-17"><a href="statistical-models-in-r-1.html#cb248-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Longevity (days)&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-108-1.png" width="480" /></p>
<p>This data visualization suggests that both sexual activity and body size/thorax length may effect longevity. Let’s confirm (or disprove) this intuition by performing a 2-way (or 2-factor) ANOVA.</p>
<p>To perform a 2-way ANOVA, we modify the formula notation that we pass into to <code>aov</code> function by adding an additional factor/category/explanatory variable through the use of the <code>+</code> sign and the name of the new variable. Thus, our formula for this case is:</p>
<pre><code>longevity ~ activity + thorax</code></pre>
<p>Everything else remains the same:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="statistical-models-in-r-1.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an ANOVA &quot;model&quot; object</span></span>
<span id="cb250-2"><a href="statistical-models-in-r-1.html#cb250-2" aria-hidden="true" tabindex="-1"></a>fruitfly_2var_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(longevity <span class="sc">~</span> activity <span class="sc">+</span> thorax,</span>
<span id="cb250-3"><a href="statistical-models-in-r-1.html#cb250-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">data =</span> fruitfly_2groups)</span>
<span id="cb250-4"><a href="statistical-models-in-r-1.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view output of aov() as a nice dataframe using tidy() from the broom package</span></span>
<span id="cb250-5"><a href="statistical-models-in-r-1.html#cb250-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fruitfly_2var_model)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 6
##   term         df  sumsq meansq statistic   p.value
##   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 activity      1  5729.  5729.      38.8  2.31e- 8
## 2 thorax        1  9658.  9658.      65.4  6.94e-12
## 3 Residuals    77 11374.   148.      NA   NA</code></pre>
<p>Now, we see that we get back an additional line in our results summary that corresponds to the hypotheses regarding the effect of body size/thorax length on longevity. The p-values for both sexual activity (<span class="math inline">\(2.3099823\times 10^{-8}\)</span>) and size (<span class="math inline">\(6.9440175\times 10^{-12}\)</span>) are very, very small. Thus, we can reject both of our null hypotheses and infer that both sexual activity and size have statistically significant effect on longevity.</p>
</div>
<div id="way-anova-with-2-groups-including-an-interaction-term" class="section level3" number="5.3.10">
<h3><span class="header-section-number">5.3.10</span> 2-way ANOVA with 2 groups including an interaction term</h3>
<p>Oftentimes when we are dealing with experiments/cases where we have 2 or more factor/category/explanatory variables, we first want to ask if there is an interaction effect between them and their influences/effects on the response variable.</p>
<p>What do we mean by interaction effect? Essentially, an interaction effect is observed when the effect of two explanatory variables on the response variable is not additive (for example, their effect could instead be synergistic).</p>
<p>Our hypotheses for whether or not there is an interaction are:</p>
<p><strong>Null Hypothesis, <span class="math inline">\(H_{0}\)</span></strong>: There is <strong>no</strong> interaction effect between sexual activity and thorax length on the mean longevity of the population.<br />
<strong>Alternative Hypothesis, <span class="math inline">\(H_{A}\)</span></strong>: There is an interaction effect between sexual activity and thorax length on the mean longevity of the population.</p>
<p>In a simple case, as presented in this experiment, we first assess the hypotheses in regards to the presence or absence of interaction. If we reject the interaction effect null hypothesis, then we interpret the data only in regards to this null hypothesis. If we fail to reject the interaction effect null hypothesis, then we can proceed and investigate/test the hypotheses for each individual factor/category/explanatory variable (often referred to as “main effects”).</p>
<p>Can we get an intuitive sense for this via visualization? Yes we can by making an interaction plot (see example below). Here, we are looking at the slope of the lines that connects the means. If the slopes of the interaction lines are parallel, then the ANOVA results will very likely tell us that we will fail to reject the interaction effect null hypothesis. On the other hand, if they are not parallel, the ANOVA results will very likely tell us to reject the interaction effect null hypothesis, and we can infer that there is an interaction effect on the response variable between the two factor/category/explanatory variables.</p>
<p>Let’s look at the interaction plot for our case:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="statistical-models-in-r-1.html#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot to investigate possible interaction effect of sexual</span></span>
<span id="cb252-2"><a href="statistical-models-in-r-1.html#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="co"># activity and thorax length on longevity</span></span>
<span id="cb252-3"><a href="statistical-models-in-r-1.html#cb252-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fruitfly_2groups,</span>
<span id="cb252-4"><a href="statistical-models-in-r-1.html#cb252-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> longevity, <span class="at">color =</span> thorax)) <span class="sc">+</span></span>
<span id="cb252-5"><a href="statistical-models-in-r-1.html#cb252-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb252-6"><a href="statistical-models-in-r-1.html#cb252-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb252-7"><a href="statistical-models-in-r-1.html#cb252-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">shape =</span> <span class="dv">18</span>,</span>
<span id="cb252-8"><a href="statistical-models-in-r-1.html#cb252-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb252-9"><a href="statistical-models-in-r-1.html#cb252-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean,</span>
<span id="cb252-10"><a href="statistical-models-in-r-1.html#cb252-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb252-11"><a href="statistical-models-in-r-1.html#cb252-11" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> thorax)) <span class="sc">+</span></span>
<span id="cb252-12"><a href="statistical-models-in-r-1.html#cb252-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;dodgerblue3&quot;</span>)) <span class="sc">+</span></span>
<span id="cb252-13"><a href="statistical-models-in-r-1.html#cb252-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Sexual Activity&quot;</span>) <span class="sc">+</span></span>
<span id="cb252-14"><a href="statistical-models-in-r-1.html#cb252-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Longevity (days)&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-110-1.png" width="480" /></p>
<p>Although not perfectly parallel, the lines on the interaction plot are pretty close to parallel. So, the ANOVA results will very likely tell us that we will fail to reject the interaction effect null hypothesis. Let’s proceed with the analysis to be sure.</p>
<p>One way to include an interaction term in your ANOVA model is to use the <code>*</code> symbol between two factor/category/explanatory variables. This causes R to test the null hypotheses for the effect of each individual factor/category/explanatory variables as well as the combined effect of these two explanatory variables. Thus, for us, our formula notation is now:</p>
<pre><code>longevity ~ activity * thorax</code></pre>
<p>Importantly, using <code>*</code> causes R to test all possible interactions. So if we had a formula <code>A * B * C</code>, it would test all combinations of the 3 variables. If instead, you want to specify specific interaction term(s), you can use <code>:</code>. In the case of our formula, this is the same as <code>*</code> but serves as an example of the other notation type.</p>
<pre><code>longevity ~ activity + thorax + activity:thorax</code></pre>
<p>Everything else about our input <code>aov</code> remains the same as our previous model.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="statistical-models-in-r-1.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create an ANOVA &quot;model&quot; object</span></span>
<span id="cb255-2"><a href="statistical-models-in-r-1.html#cb255-2" aria-hidden="true" tabindex="-1"></a>fruitfly_2var_model2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(longevity <span class="sc">~</span> activity <span class="sc">*</span> thorax,</span>
<span id="cb255-3"><a href="statistical-models-in-r-1.html#cb255-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">data =</span> fruitfly_2groups)</span>
<span id="cb255-4"><a href="statistical-models-in-r-1.html#cb255-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view output of aov() as a nice dataframe using tidy() from the broom package</span></span>
<span id="cb255-5"><a href="statistical-models-in-r-1.html#cb255-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(fruitfly_2var_model2)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 6
##   term               df    sumsq  meansq statistic   p.value
##   &lt;chr&gt;           &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 activity            1  5729.   5729.     38.3     2.83e- 8
## 2 thorax              1  9658.   9658.     64.6     9.41e-12
## 3 activity:thorax     1     6.61    6.61    0.0442  8.34e- 1
## 4 Residuals          76 11367.    150.     NA      NA</code></pre>
<p>As stated above, as a rule of thumb for cases such as these, the first hypotheses we should attend to are those regarding the interaction effect (or lack thereof). We can see our output from ANOVA now has an additional line that refers to the testing of the interaction effect hypothesis.</p>
<p><span class="math inline">\(activity:thorax, 1, 6.6125, 6.6125, 0.0442107, 0.8340247\)</span></p>
<p>We observe that the p-value from this line is not very small, <span class="math inline">\(0.8340247\)</span>, and not less than the standard p-value threshold for rejecting null hypotheses (0.05). Thus, as our interaction plot suggested, we fail to reject the null hypotheses and conclude that there is <strong>no</strong> interaction effect between sexual activity and thorax length on the mean longevity of the population).</p>
<p>We would then proceed to investigate the hypotheses of each main effect independently. This could be done by either interpreting the relevant p-values from our current ANOVA results table, or re-running the analysis without the interaction term (as done in the previous case).</p>
<div id="exercise-anova" class="section level4" number="5.3.10.1">
<h4><span class="header-section-number">5.3.10.1</span> Exercise: ANOVA</h4>
<p>Determine whether the following statements are <em>true or false</em>?</p>
<ol style="list-style-type: decimal">
<li><p>ANOVA tests the null hypothesis that the sample means are all equal?</p></li>
<li><p>We use ANOVA to compare the variances of the population?</p></li>
<li><p>A one-way ANOVA is equivalent to a <em>t</em>-test when there are 2 groups to be compared.</p></li>
<li><p>In rejecting the null hypothesis, one can conclude that all the population means are different from one another?</p></li>
</ol>
<p><em>Questions courtesy of Dr. Gabriela Cohen Freue’s DSCI 562 course (UBC)</em></p>
<hr />
<p>If you are attending a 3 x 2-hour workshop, this is the end of day 1</p>
<hr />
</div>
</div>
</div>
<div id="linear-regression" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Linear regression</h2>
<div id="load-and-explore-the-data-1" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Load and explore the data</h3>
<p>Now, we will work with a data frame that Jennifer Bryan (U. of British Columbia, RStudio) put together in the <a href="http://www.gapminder.org/data/"><code>gapminder</code> package</a>.</p>
<p>Unlike the fruit fly data, no pre-manipulation is needed so let’s view these data as is.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="statistical-models-in-r-1.html#cb257-1" aria-hidden="true" tabindex="-1"></a>gapminder</span></code></pre></div>
<pre><code>## # A tibble: 1,704 x 6
##    country     continent  year lifeExp      pop gdpPercap
##    &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
##  1 Afghanistan Asia       1952    28.8  8425333      779.
##  2 Afghanistan Asia       1957    30.3  9240934      821.
##  3 Afghanistan Asia       1962    32.0 10267083      853.
##  4 Afghanistan Asia       1967    34.0 11537966      836.
##  5 Afghanistan Asia       1972    36.1 13079460      740.
##  6 Afghanistan Asia       1977    38.4 14880372      786.
##  7 Afghanistan Asia       1982    39.9 12881816      978.
##  8 Afghanistan Asia       1987    40.8 13867957      852.
##  9 Afghanistan Asia       1992    41.7 16317921      649.
## 10 Afghanistan Asia       1997    41.8 22227415      635.
## # … with 1,694 more rows</code></pre>
<p>We see that the data contain information on life expectancy (lifeExp), population (pop), and gross domestic product per capita (gdpPercap, a rough measure of economical richness) for many countries across many years.</p>
<p>A very naive working hypothesis that you may come to is that our life expectancy grew with time. This would be represent in r with <code>lifeExp ~ year</code>.</p>
<p>We can explore this hypothesis graphically.</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="statistical-models-in-r-1.html#cb259-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb259-2"><a href="statistical-models-in-r-1.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb259-3"><a href="statistical-models-in-r-1.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb259-4"><a href="statistical-models-in-r-1.html#cb259-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Life expectancy (yrs)&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
<p>Although there is very high variance, we do see a certain trend with mean life expectancy increasing over time.</p>
<p>Similarly, we can naively hypothesize that life expectancy is higher where the per-capita gdp is higher. In R, this is <code>lifeExp ~ gdpPercap</code>.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="statistical-models-in-r-1.html#cb260-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb260-2"><a href="statistical-models-in-r-1.html#cb260-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb260-3"><a href="statistical-models-in-r-1.html#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb260-4"><a href="statistical-models-in-r-1.html#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Life expectancy (yrs)&quot;</span>, <span class="at">x=</span><span class="st">&quot;Per-capita GDP&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>
<div id="linear-models" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Linear models</h3>
<p>A <strong>linear regression</strong> model describes the change of a <em>dependent</em> variable, say <code>lifeExp</code>, as a <em>linear</em> function of one or more <em>explanatory</em> variables, say <code>year</code>. This means that increasing by <span class="math inline">\(x\)</span> the variable <code>year</code> will have an effect <span class="math inline">\(\beta \cdot x\)</span> on the <em>dependent</em> variable <code>lifeExp</code>, whatever the value <span class="math inline">\(x\)</span> is. In mathematical terms:
<span class="math display">\[
\mbox{lifeExp} = \alpha + \beta \cdot \mbox{year}
\]</span></p>
<p>We call <span class="math inline">\(\alpha\)</span> the intercept of the model, or the value of <code>lifeExp</code> when <code>year</code> is equal to zero. When we go forward in time, increasing <code>year</code>, <code>lifeExp</code> increases (if <span class="math inline">\(\beta\)</span> is positive, otherwise it decreases):
<span class="math display">\[
\alpha + \beta \cdot \left(\mbox{year} + x \right) = \alpha + \beta \cdot \mbox{year} + \beta \cdot x = \mbox{lifeExp} + \beta \cdot x
\]</span></p>
</div>
<div id="key-assumptions-1" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Key assumptions</h3>
<p>number of assumptions must be satisfied for a linear model to be reliable. These are:</p>
<ul>
<li>the predictor variables should be measured with not too much error (<strong>weak exogeneity</strong>)</li>
<li>the variance of the response variable should be roughly the same across the range of its predictors (<strong>homoscedasticity</strong>, a fancy pants word for “constant variance”)</li>
<li>the discrepancies between observed and predicted values should be <strong>independent</strong></li>
<li>the predictors themselves should be <strong>non-colinear</strong> (a rather technical issues, given by the way we solve the model, that may happen when two predictors are perfectly correlated or we try to estimate the effect of too many predictors with too little data).</li>
</ul>
<p>Here, we only mention these assumptions, but for more details, take a look at <a href="https://en.wikipedia.org/wiki/Linear_regression#Assumptions">wiki</a>.</p>
<p>When we have only one predictive variable (what is called a <em>simple</em> linear regression model), the formula we just introduced describes a straight line. The task of a linear regression method is identifying the <em>best fitting</em> slope and intercept of that straight line. But what does <em>best fitting</em> means in this context? We will first adopt a heuristic definition of it but will rigorously define it later on.</p>
<p>Let’s consider a bunch of straight lines in our first plot:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="statistical-models-in-r-1.html#cb261-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb261-2"><a href="statistical-models-in-r-1.html#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb261-3"><a href="statistical-models-in-r-1.html#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb261-4"><a href="statistical-models-in-r-1.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="fl">0.033</span>, <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-5"><a href="statistical-models-in-r-1.html#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="sc">-</span><span class="dv">575</span>, <span class="at">slope =</span> <span class="fl">0.32</span>, <span class="at">colour =</span> <span class="st">&quot;purple&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-6"><a href="statistical-models-in-r-1.html#cb261-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(lifeExp)), <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-7"><a href="statistical-models-in-r-1.html#cb261-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(year)), <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb261-8"><a href="statistical-models-in-r-1.html#cb261-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Life expectancy (yrs)&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-115-1.png" width="672" /></p>
<p><strong>So, which line best describes the data? To determine this, we must fit a linear model to the data.</strong></p>
</div>
<div id="simple-linear-regression" class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Simple linear regression</h3>
<p>To obtain the slope and intercept of the green line, we can use the built-in R function <code>lm()</code>. This function works very similarly to the <code>aov</code> function we used earlier in that we must give it a model and data. The output of <code>lm()</code> is also messy but we want to use <code>summary</code> instead of <code>tidy</code> in order to see all the relevant results.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="statistical-models-in-r-1.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a lm &quot;model&quot; object</span></span>
<span id="cb262-2"><a href="statistical-models-in-r-1.html#cb262-2" aria-hidden="true" tabindex="-1"></a>lifeExp_model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year, </span>
<span id="cb262-3"><a href="statistical-models-in-r-1.html#cb262-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> gapminder)</span>
<span id="cb262-4"><a href="statistical-models-in-r-1.html#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view output of lm() as using summary()</span></span>
<span id="cb262-5"><a href="statistical-models-in-r-1.html#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lifeExp_model1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year, data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -39.949  -9.651   1.697  10.335  22.158 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -585.65219   32.31396  -18.12   &lt;2e-16 ***
## year           0.32590    0.01632   19.96   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.63 on 1702 degrees of freedom
## Multiple R-squared:  0.1898, Adjusted R-squared:  0.1893 
## F-statistic: 398.6 on 1 and 1702 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Now, however, we are interested in more than just the p-value.</p>
<p>The <code>Estimate</code> values are the best fit for the intercept, <span class="math inline">\(\alpha\)</span>, and the slope, <span class="math inline">\(\beta\)</span>. The slope, the parameter the links <code>year</code> to <code>lifeExp</code>, is a positive value: every 1 year, the life expectancy increases of <span class="math inline">\(0.3259038\)</span> years. This is in line with our hypothesis. Moreover, its p-value, the probability of finding a correlation at least as strong between predictive and response variable, is rather low at <span class="math inline">\(7.5467946\times 10^{-80}\)</span> (but see <a href="https://backyardbrains.com/experiments/p-value">this</a> for a cautionary tale about p-values!).</p>
<p>Using this slope and intercept, we can plot this best fit line on our data.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="statistical-models-in-r-1.html#cb264-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb264-2"><a href="statistical-models-in-r-1.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb264-3"><a href="statistical-models-in-r-1.html#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb264-4"><a href="statistical-models-in-r-1.html#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&quot;green&quot;</span>) <span class="sc">+</span></span>
<span id="cb264-5"><a href="statistical-models-in-r-1.html#cb264-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Life expectancy (yrs)&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<p>Another important bit of information in our results is the R-squared values, both are the <em>Multiple</em> and <em>Adjusted R-squared</em>. These tell us how much of <em>variance</em> in the life expectancy data is explained by the year. In this case, not much (0.1897571, 0.1892811, respectively)</p>
</div>
<div id="residuals" class="section level3" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Residuals</h3>
<p>We can further explore our linear model by plotting some diagnostic plots. Base R provides a quick and easy way to view all of these plots at once with <code>plot</code>.</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="statistical-models-in-r-1.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot frame to 2 by 2</span></span>
<span id="cb266-2"><a href="statistical-models-in-r-1.html#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb266-3"><a href="statistical-models-in-r-1.html#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create diagnostic plots</span></span>
<span id="cb266-4"><a href="statistical-models-in-r-1.html#cb266-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lifeExp_model1)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-118-1.png" width="672" /></p>
<p>Whoa right?! Let’s break it down. Overall, these diagnostic plots are useful for understanding the model <em>residuals</em>. The residuals are the discrepancies between the life expectancy we would have guessed by the model and the observed values in the available data. In other words, the distances between the straight line and actual data points. In a linear regression model, these residuals are the values we try to minimize when we fit the straight line.</p>
<p>There is a lot of information contained in these 4 plots, and you can find in-depth explanations <a href="https://data.library.virginia.edu/diagnostic-plots/">here</a>. For our purposes today, let’s focus on just the Residuals vs Fitted and Normal Q-Q plots.</p>
<p>The Residuals vs Fitted plot shows the differences between the best fit line and all the available data points. When the model is a good fit for the data, this plot should have no discernible pattern. That is, the red line should not form a shape like an ‘S’ or a parabola. Another way to look it is that the points should look like ‘stars in the sky,’ <em>e.g.</em> random. This second description is not great for these data since year is an integer (whole number) but we do see that the red line is relatively straight and without pattern.</p>
<p>The Normal Q-Q plot directly compares the best fit and actual data values. A good model closely adheres to dotted line and points that fall off the line should not portray any pattern. In our case, this plot indicates that this simple linear model may not be the best fit for these data. Notice how either end deviates more and more from the line and the plot forms somewhat of an ‘S’ pattern.</p>
<p>These ends are particularly important in a linear model. Because we’ve chosen to use a simple linear model, <em>outliers</em>, or observed values that are very far away from our best fit line, are very important (in jargon, they have a high <em>leverage</em>, see the fourth diagnostic plot). This is especially true if the outliers are at the edge of the predicting variable ranges such as we see in our Q-Q plot.</p>
<div id="exercise-linear-models" class="section level4" number="5.4.5.1">
<h4><span class="header-section-number">5.4.5.1</span> Exercise: Linear models</h4>
<ol style="list-style-type: decimal">
<li><p>Looking at the summary plots above, do you feel that our model can be extrapolated to a much wider <code>year</code> range? Why or why not?</p></li>
<li><p>Fit a linear model of life expectancy as a function of per-capita gdp. Using the summary table and diagnostic plots, discuss whether or not you think this is a good fit for these data.</p></li>
</ol>
<hr />
<p>If you are attending a 2 x 3-hour workshop, this is the end of day 1</p>
<hr />
</div>
</div>
</div>
<div id="cautions-when-using-linear-models" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Cautions when using linear models</h2>
<p>R (and most other statistical software) will fit, plot, summarize, etc. a linear model regardless of whether that model is a good fit for the data.</p>
<p>For example, the Anscombe data sets are very different data that give the <em>same slope, intercept, and mean</em> in a linear model.</p>
<p>We can access these data in R and format them with</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="statistical-models-in-r-1.html#cb267-1" aria-hidden="true" tabindex="-1"></a>absc <span class="ot">&lt;-</span> <span class="fu">with</span>(datasets<span class="sc">::</span>anscombe,</span>
<span id="cb267-2"><a href="statistical-models-in-r-1.html#cb267-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">tibble</span>(<span class="at">X=</span><span class="fu">c</span>(x1,x2,x3,x4),</span>
<span id="cb267-3"><a href="statistical-models-in-r-1.html#cb267-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Y=</span><span class="fu">c</span>(y1,y2,y3,y4),</span>
<span id="cb267-4"><a href="statistical-models-in-r-1.html#cb267-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">anscombe_quartet=</span><span class="fu">gl</span>(<span class="dv">4</span>,<span class="fu">nrow</span>(datasets<span class="sc">::</span>anscombe))</span>
<span id="cb267-5"><a href="statistical-models-in-r-1.html#cb267-5" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb267-6"><a href="statistical-models-in-r-1.html#cb267-6" aria-hidden="true" tabindex="-1"></a>             )</span></code></pre></div>
<p>Plotting these data reveals the problem.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="statistical-models-in-r-1.html#cb268-1" aria-hidden="true" tabindex="-1"></a>absc <span class="sc">%&gt;%</span></span>
<span id="cb268-2"><a href="statistical-models-in-r-1.html#cb268-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y,<span class="at">group=</span>anscombe_quartet)) <span class="sc">+</span></span>
<span id="cb268-3"><a href="statistical-models-in-r-1.html#cb268-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb268-4"><a href="statistical-models-in-r-1.html#cb268-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb268-5"><a href="statistical-models-in-r-1.html#cb268-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb268-6"><a href="statistical-models-in-r-1.html#cb268-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>anscombe_quartet)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-120-1.png" width="672" /></p>
<p><strong>This is why you should always, always, always plot your data before attempting regression!</strong></p>
</div>
<div id="multiple-linear-regression" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Multiple linear regression</h2>
<p>So far, we have dealt with simple regression models, where we had only one predictor variable. However, <code>lm()</code> handles much more complex models. Consider for example a model of life expectancy as a function of both the year and the per-capita gdp.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="statistical-models-in-r-1.html#cb270-1" aria-hidden="true" tabindex="-1"></a>lifeExp <span class="sc">~</span> year <span class="sc">+</span> gdpPercap</span></code></pre></div>
<pre><code>## lifeExp ~ year + gdpPercap</code></pre>
<p>This formula does not describe a straight line anymore, but a plane in a 3D space. Still a very flat thingy.</p>
<p>Let’s fit this model.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="statistical-models-in-r-1.html#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a lm &quot;model&quot; object</span></span>
<span id="cb272-2"><a href="statistical-models-in-r-1.html#cb272-2" aria-hidden="true" tabindex="-1"></a>lifeExp_model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year <span class="sc">+</span> gdpPercap, </span>
<span id="cb272-3"><a href="statistical-models-in-r-1.html#cb272-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> gapminder)</span>
<span id="cb272-4"><a href="statistical-models-in-r-1.html#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="co"># view output of lm() as using summary()</span></span>
<span id="cb272-5"><a href="statistical-models-in-r-1.html#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lifeExp_model2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year + gdpPercap, data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -67.262  -6.954   1.219   7.759  19.553 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -4.184e+02  2.762e+01  -15.15   &lt;2e-16 ***
## year         2.390e-01  1.397e-02   17.11   &lt;2e-16 ***
## gdpPercap    6.697e-04  2.447e-05   27.37   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.694 on 1701 degrees of freedom
## Multiple R-squared:  0.4375, Adjusted R-squared:  0.4368 
## F-statistic: 661.4 on 2 and 1701 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can assess this model with plots similar to our simple linear regression.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="statistical-models-in-r-1.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb274-2"><a href="statistical-models-in-r-1.html#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lifeExp_model2)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-123-1.png" width="672" /></p>
<div id="multiple-is-the-formula-not-the-predictor" class="section level3" number="5.6.1">
<h3><span class="header-section-number">5.6.1</span> Multiple is the formula, not the predictor</h3>
<p>The linearity of a model is in how the predictive variables are put together, not necessarily in the predictors themselves. In the last exercise, you saw that <code>gdpPercap</code> is not the best predictor of <code>lifeExp</code> because it does not seem to fit linearly. This carries forward into our multiple linear regression as is apparent in the last plot.</p>
<p>One way to improve our model is to use a transformed <code>gdpPercap</code> predictor. But transformed how?</p>
<p>Let’s pick a (silly) function to start. Here, we take the sine of the <code>gdpPercap</code>.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="statistical-models-in-r-1.html#cb275-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb275-2"><a href="statistical-models-in-r-1.html#cb275-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">sin</span>(gdpPercap), <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb275-3"><a href="statistical-models-in-r-1.html#cb275-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-124-1.png" width="672" /></p>
<p>Doesn’t look much better.</p>
<div id="exercise-transforming-predictors" class="section level4" number="5.6.1.1">
<h4><span class="header-section-number">5.6.1.1</span> Exercise: Transforming predictors</h4>
<ol style="list-style-type: decimal">
<li>Find a function that makes the plot more “linear” and fit a model of life expectancy as a function of the transformed per-capita gdp. Is it a better model?
<ul>
<li>Go back to your original <code>gdpPercap</code> vs. <code>lifeExp</code> plot and think about what function creates a similar trend.</li>
</ul></li>
</ol>
</div>
</div>
<div id="transforming-predictors-log" class="section level3" number="5.6.2">
<h3><span class="header-section-number">5.6.2</span> Transforming predictors: log</h3>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="statistical-models-in-r-1.html#cb276-1" aria-hidden="true" tabindex="-1"></a>lifeExp_model3a <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">log</span>(gdpPercap),</span>
<span id="cb276-2"><a href="statistical-models-in-r-1.html#cb276-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> gapminder)</span></code></pre></div>
<p>Or we can create a new variable in the data frame and use that variable in the model</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="statistical-models-in-r-1.html#cb277-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb277-2"><a href="statistical-models-in-r-1.html#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_gdp =</span> <span class="fu">log</span>(gdpPercap))</span>
<span id="cb277-3"><a href="statistical-models-in-r-1.html#cb277-3" aria-hidden="true" tabindex="-1"></a>lifeExp_model3b <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year <span class="sc">+</span> log_gdp,</span>
<span id="cb277-4"><a href="statistical-models-in-r-1.html#cb277-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> gapminder)</span></code></pre></div>
<p>Both yield the same result.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="statistical-models-in-r-1.html#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lifeExp_model3a)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year + log(gdpPercap), data = gapminder)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -27.2291  -3.8454   0.6065   4.7737  17.8644 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -3.911e+02  1.942e+01  -20.14   &lt;2e-16 ***
## year            1.956e-01  9.927e-03   19.70   &lt;2e-16 ***
## log(gdpPercap)  7.770e+00  1.381e-01   56.27   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.877 on 1701 degrees of freedom
## Multiple R-squared:  0.7169, Adjusted R-squared:  0.7165 
## F-statistic:  2153 on 2 and 1701 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="statistical-models-in-r-1.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lifeExp_model3b)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year + log_gdp, data = gapminder)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -27.2291  -3.8454   0.6065   4.7737  17.8644 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -3.911e+02  1.942e+01  -20.14   &lt;2e-16 ***
## year         1.956e-01  9.927e-03   19.70   &lt;2e-16 ***
## log_gdp      7.770e+00  1.381e-01   56.27   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.877 on 1701 degrees of freedom
## Multiple R-squared:  0.7169, Adjusted R-squared:  0.7165 
## F-statistic:  2153 on 2 and 1701 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="transforming-predictors-polynomial" class="section level3" number="5.6.3">
<h3><span class="header-section-number">5.6.3</span> Transforming predictors: polynomial</h3>
<p>Another option is using a <em>polynomial</em> transformation of our model.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="statistical-models-in-r-1.html#cb282-1" aria-hidden="true" tabindex="-1"></a>lifeExp_model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year <span class="sc">+</span> <span class="fu">poly</span>(gdpPercap),</span>
<span id="cb282-2"><a href="statistical-models-in-r-1.html#cb282-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> gapminder)</span>
<span id="cb282-3"><a href="statistical-models-in-r-1.html#cb282-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lifeExp_model4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year + poly(gdpPercap), data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -67.262  -6.954   1.219   7.759  19.553 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     -413.59192   27.65674  -14.95   &lt;2e-16 ***
## year               0.23898    0.01397   17.11   &lt;2e-16 ***
## poly(gdpPercap)  272.44154    9.95433   27.37   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.694 on 1701 degrees of freedom
## Multiple R-squared:  0.4375, Adjusted R-squared:  0.4368 
## F-statistic: 661.4 on 2 and 1701 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Or explicit write a polynomial equation for one of our predictor.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="statistical-models-in-r-1.html#cb284-1" aria-hidden="true" tabindex="-1"></a>lifeExp_model5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year <span class="sc">+</span> gdpPercap <span class="sc">+</span> <span class="fu">I</span>(gdpPercap<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb284-2"><a href="statistical-models-in-r-1.html#cb284-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> gapminder)</span>
<span id="cb284-3"><a href="statistical-models-in-r-1.html#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lifeExp_model5)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year + gdpPercap + I(gdpPercap^2), data = gapminder)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -31.1048  -6.3211   0.3511   6.8441  25.7228 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    -3.088e+02  2.426e+01  -12.73   &lt;2e-16 ***
## year            1.819e-01  1.228e-02   14.81   &lt;2e-16 ***
## gdpPercap       1.396e-03  3.671e-05   38.02   &lt;2e-16 ***
## I(gdpPercap^2) -1.344e-08  5.558e-10  -24.18   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8.364 on 1700 degrees of freedom
## Multiple R-squared:  0.5814, Adjusted R-squared:  0.5807 
## F-statistic: 787.1 on 3 and 1700 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><em>Note</em> that we must use <code>I(gdpPercap^2)</code> instead of <code>gdpPercap^2</code> because the symbols <code>^</code>, <code>*</code>, and <code>:</code> have a particular meaning in a linear model. As we saw in ANOVA, these symbols are used to specify <em>interactions</em> between predicting variables.</p>
<div id="exercise-multiple-linear-regression" class="section level4" number="5.6.3.1">
<h4><span class="header-section-number">5.6.3.1</span> Exercise: Multiple linear regression</h4>
<ol style="list-style-type: decimal">
<li>So far, we have worked with <code>lifeExp</code> as our independent variable. Now, in small groups, try to produce a model of population (<code>pop</code>) using one or more of the variables available in <code>gapminder</code>.</li>
</ol>
<hr />
<p>If you are attending a 3 x 2-hour workshop, this is the end of day 2</p>
<hr />
</div>
</div>
<div id="interactions-and-analysis-of-covarianvce-ancova" class="section level3" number="5.6.4">
<h3><span class="header-section-number">5.6.4</span> Interactions and ANalysis of COVArianvce (ANCOVA)</h3>
<p>So far, our models for life expectancy have built upon continuous (or discrete but incremental) variables. However, we may wonder if being in one continent rather than another has a differential effect on the correlation between <code>year</code> and <code>lifeExp</code>.</p>
<p>Let’s take a look at our data set now with continent in mind.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="statistical-models-in-r-1.html#cb286-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb286-2"><a href="statistical-models-in-r-1.html#cb286-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">colour =</span> continent)) <span class="sc">+</span></span>
<span id="cb286-3"><a href="statistical-models-in-r-1.html#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb286-4"><a href="statistical-models-in-r-1.html#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb286-5"><a href="statistical-models-in-r-1.html#cb286-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Life expectancy (yrs)&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>The slopes for each continent seem different, but how can we tell if the difference is significant? Here’s where we can combine our linear model with the ANOVA function we learned earlier!</p>
<p>First, using the special character <code>*</code>, we model the effects of year, continent, and their interaction on life expectancy.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="statistical-models-in-r-1.html#cb288-1" aria-hidden="true" tabindex="-1"></a>lifeExp_model6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year<span class="sc">*</span>continent,</span>
<span id="cb288-2"><a href="statistical-models-in-r-1.html#cb288-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> gapminder)</span></code></pre></div>
<p>Then, we call the ANOVA function <code>aov()</code> on the model:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="statistical-models-in-r-1.html#cb289-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(lifeExp_model6))</span></code></pre></div>
<pre><code>##                  Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## year              1  53919   53919  1046.0  &lt; 2e-16 ***
## continent         4 139343   34836   675.8  &lt; 2e-16 ***
## year:continent    4   3566     892    17.3 6.46e-14 ***
## Residuals      1694  87320      52                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Based on these results, it really seems that the continent should have a role in the model. However, it is not always like this. Let’s take a closer look at Europe and Oceania.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="statistical-models-in-r-1.html#cb291-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb291-2"><a href="statistical-models-in-r-1.html#cb291-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Oceania&quot;</span>,<span class="st">&quot;Europe&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb291-3"><a href="statistical-models-in-r-1.html#cb291-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(lifeExp <span class="sc">~</span> year<span class="sc">*</span>continent, <span class="at">data =</span> .) <span class="sc">%&gt;%</span> </span>
<span id="cb291-4"><a href="statistical-models-in-r-1.html#cb291-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aov</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb291-5"><a href="statistical-models-in-r-1.html#cb291-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>##                 Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## year             1   5598    5598 399.070 &lt; 2e-16 ***
## continent        1    132     132   9.414 0.00231 ** 
## year:continent   1      1       1   0.065 0.79895    
## Residuals      380   5330      14                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p><em>Note that this is an example of how the tidyverse can be used to link together a bunch of functions, instead of creating many new R objects as we’ve been doing thus far.</em></p>
<p>When just looking at Oceania and Europe, continent has a significant effect on the <em>intercept</em> of the model, but not on its <em>slope</em>. This makes sense since in our plot, these lines (blue and purple) appear parallel but with different y-intercepts.</p>
</div>
</div>
<div id="linear-mixed-effects-models" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Linear Mixed Effects models</h2>
<div id="motivations-for-lme" class="section level3" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Motivations for LME</h3>
<p>Let’s take a look at the <code>esoph</code> data set, which comes pre-downloaded in R. These data contain information on smoking, alcoholism, and (o)esophageal cancer. Specifically, we are interested in if the number of controls <code>ncontrols</code> affects the number of cases <code>ncases</code> of cancer for each age group <code>agegp</code>.</p>
<p>Here’s what the data look like (with a tad bit of vertical jitter):</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="statistical-models-in-r-1.html#cb293-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(esoph, <span class="fu">aes</span>(ncontrols, ncases, <span class="at">group=</span>agegp, <span class="at">colour=</span>agegp)) <span class="sc">+</span></span>
<span id="cb293-2"><a href="statistical-models-in-r-1.html#cb293-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">height=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb293-3"><a href="statistical-models-in-r-1.html#cb293-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="st">&quot;Age Group&quot;</span>) <span class="sc">+</span></span>
<span id="cb293-4"><a href="statistical-models-in-r-1.html#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of Cases&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Number of Controls&quot;</span>)</span>
<span id="cb293-5"><a href="statistical-models-in-r-1.html#cb293-5" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-134-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>It seems each age group has a different relationship. Should we then fit regression lines for each group separately? Here’s what we get, if we do.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="statistical-models-in-r-1.html#cb294-1" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">size=</span><span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-135-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>But each group has so few observations which makes the regression less powerful.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="statistical-models-in-r-1.html#cb296-1" aria-hidden="true" tabindex="-1"></a>esoph <span class="sc">%&gt;%</span></span>
<span id="cb296-2"><a href="statistical-models-in-r-1.html#cb296-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(agegp) <span class="sc">%&gt;%</span></span>
<span id="cb296-3"><a href="statistical-models-in-r-1.html#cb296-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">n=</span><span class="fu">length</span>(ncases)) <span class="sc">%&gt;%</span></span>
<span id="cb296-4"><a href="statistical-models-in-r-1.html#cb296-4" aria-hidden="true" tabindex="-1"></a>    as.data.frame</span></code></pre></div>
<pre><code>##   agegp  n
## 1 25-34 15
## 2 35-44 15
## 3 45-54 16
## 4 55-64 16
## 5 65-74 15
## 6   75+ 11</code></pre>
<p><strong>Question</strong>: can we borrow information across groups to strengthen regression, while still allowing each group to have its own regression line?</p>
<p>Yes – we can use <em>Linear Mixed Effects</em> (LME) models. An LME model is just a linear regression model for each group, with different slopes and intercepts, but the collection of slopes and intercepts <em>is assumed to come from some normal distribution</em>.</p>
</div>
<div id="definitions" class="section level3" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Definitions</h3>
<p>With one predictor (<span class="math inline">\(X\)</span>), we can write an LME as follows:
<span class="math display">\[ Y = \left(\beta_0 + b_0\right) + \left(\beta_1 + b_1\right) X + \varepsilon,  \]</span>
where the error term <span class="math inline">\(\varepsilon\)</span> has mean zero, and the <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> terms are normally distributed having a mean of zero, and some unknown variances and correlation. The <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> terms indicate group-to-group differences from average.</p>
<p>The <span class="math inline">\(\beta\)</span> terms are called the <em>fixed effects</em>, and the <span class="math inline">\(b\)</span> terms are called the <em>random effects</em>. Since the model has both types of effects, it’s said to be a <em>mixed</em> model – hence the name of “LME.”</p>
<p>Note that we don’t have to make <em>both</em> the slope and intercept random. For example, we can remove the <span class="math inline">\(b_0\)</span> term, which would mean that each group is forced to have the same (fixed) intercept <span class="math inline">\(\beta_0\)</span>. Also, we can add more predictors (<span class="math inline">\(X\)</span> variables).</p>
</div>
<div id="fitting-lme" class="section level3" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Fitting LME</h3>
<p>Two R packages exist for working with mixed effects models: <code>lme4</code> and <code>nlme</code>. We’ll be using the <code>lme4</code> package (check out <a href="http://stats.stackexchange.com/questions/5344/how-to-choose-nlme-or-lme4-r-library-for-mixed-effects-models">this</a> discussion on Cross Validated for a comparison of the two packages).</p>
<p>Let’s fit the model. Just like our other models we need to give a formula and data.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="statistical-models-in-r-1.html#cb298-1" aria-hidden="true" tabindex="-1"></a>esoph_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ncases <span class="sc">~</span> ncontrols <span class="sc">+</span> (ncontrols <span class="sc">|</span> agegp),</span>
<span id="cb298-2"><a href="statistical-models-in-r-1.html#cb298-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>esoph)</span></code></pre></div>
<p>Let’s take a closer look at the <em>formula</em>, which in this case is <code>ncases ~ ncontrols + (ncontrols | agegp)</code>.</p>
<p>On the left of the <code>~</code> is the response variable, as usual (just like for <code>lm</code>). On the right, we need to specify both the fixed and random effects. The <strong>fixed effects</strong> part is the same as usual: <code>ncontrols</code> indicates the explanatory variables that get a fixed effect. Then, we need to indicate which explanatory variables get a <strong>random effect</strong>. The random effects can be indicated in parentheses, separated by <code>+</code>, followed by a <code>|</code>, after which the variable(s) that you wish to group by are indicated. So <code>|</code> can be interpreted as “grouped by.”</p>
<p>Now let’s look at the model output:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="statistical-models-in-r-1.html#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(esoph_model)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: ncases ~ ncontrols + (ncontrols | agegp)
##    Data: esoph
## 
## REML criterion at convergence: 388.6
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.6511 -0.3710 -0.1301  0.3683  4.8056 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr
##  agegp    (Intercept) 1.69426  1.3016       
##           ncontrols   0.00573  0.0757   0.26
##  Residual             3.73290  1.9321       
## Number of obs: 88, groups:  agegp, 6
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  1.63379    0.59991   2.723
## ncontrols    0.04971    0.03677   1.352
## 
## Correlation of Fixed Effects:
##           (Intr)
## ncontrols 0.038</code></pre>
<p>The random and fixed effects are indicated here.</p>
<ul>
<li>Under the “Random effects:” section, we have the variance of each random effect, and the lower part of the correlation matrix of these random effects.</li>
<li>Under the “Fixed effects:” section, we have the estimates of the fixed effects, as well as the uncertainty in the estimate (indicated by the Std. Error).</li>
</ul>
<p>We can extract the collection of slopes and intercepts for each group with our handy <code>tidy</code> function.</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="statistical-models-in-r-1.html#cb301-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(esoph_model)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   effect   group    term                       estimate std.error statistic
##   &lt;chr&gt;    &lt;chr&gt;    &lt;chr&gt;                         &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 fixed    &lt;NA&gt;     (Intercept)                  1.63      0.600       2.72
## 2 fixed    &lt;NA&gt;     ncontrols                    0.0497    0.0368      1.35
## 3 ran_pars agegp    sd__(Intercept)              1.30     NA          NA   
## 4 ran_pars agegp    cor__(Intercept).ncontrols   0.259    NA          NA   
## 5 ran_pars agegp    sd__ncontrols                0.0757   NA          NA   
## 6 ran_pars Residual sd__Observation              1.93     NA          NA</code></pre>
<p>Alternatively, we can use the <code>coef</code> function:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="statistical-models-in-r-1.html#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(esoph_model)</span></code></pre></div>
<pre><code>## $agegp
##       (Intercept)    ncontrols
## 25-34   0.2674414 -0.002916658
## 35-44   0.7227576 -0.001128636
## 45-54   2.2834044  0.036587951
## 55-64   3.5107945  0.064244491
## 65-74   1.8699071  0.171921200
## 75+     1.1484472  0.029580126
## 
## attr(,&quot;class&quot;)
## [1] &quot;coef.mer&quot;</code></pre>
<p>Let’s put these regression lines on the plot. First, we must extract the relevant slopes and intercepts.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="statistical-models-in-r-1.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Put the slopes and intercepts with orignal data</span></span>
<span id="cb305-2"><a href="statistical-models-in-r-1.html#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Exact slopes and intercepts</span></span>
<span id="cb305-3"><a href="statistical-models-in-r-1.html#cb305-3" aria-hidden="true" tabindex="-1"></a>par_coll <span class="ot">&lt;-</span> <span class="fu">coef</span>(esoph_model)<span class="sc">$</span>agegp <span class="sc">%&gt;%</span> </span>
<span id="cb305-4"><a href="statistical-models-in-r-1.html#cb305-4" aria-hidden="true" tabindex="-1"></a>            tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>()</span>
<span id="cb305-5"><a href="statistical-models-in-r-1.html#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Bind to orig data</span></span>
<span id="cb305-6"><a href="statistical-models-in-r-1.html#cb305-6" aria-hidden="true" tabindex="-1"></a>esoph <span class="ot">&lt;-</span> <span class="fu">ddply</span>(esoph, <span class="sc">~</span> agegp, <span class="cf">function</span>(df){</span>
<span id="cb305-7"><a href="statistical-models-in-r-1.html#cb305-7" aria-hidden="true" tabindex="-1"></a>    pars <span class="ot">&lt;-</span> <span class="fu">subset</span>(par_coll, rowname<span class="sc">==</span><span class="fu">unique</span>(df<span class="sc">$</span>agegp))</span>
<span id="cb305-8"><a href="statistical-models-in-r-1.html#cb305-8" aria-hidden="true" tabindex="-1"></a>    int <span class="ot">&lt;-</span> pars<span class="sc">$</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span></span>
<span id="cb305-9"><a href="statistical-models-in-r-1.html#cb305-9" aria-hidden="true" tabindex="-1"></a>    slp <span class="ot">&lt;-</span> pars<span class="sc">$</span>ncontrols</span>
<span id="cb305-10"><a href="statistical-models-in-r-1.html#cb305-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cbind</span>(df, <span class="at">intercept=</span>int, <span class="at">slope=</span>slp)</span>
<span id="cb305-11"><a href="statistical-models-in-r-1.html#cb305-11" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Then we can add these lines to the plot.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="statistical-models-in-r-1.html#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb306-2"><a href="statistical-models-in-r-1.html#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(esoph, <span class="fu">aes</span>(ncontrols, ncases, <span class="at">group=</span>agegp, <span class="at">colour=</span>agegp)) <span class="sc">+</span></span>
<span id="cb306-3"><a href="statistical-models-in-r-1.html#cb306-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">height=</span><span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb306-4"><a href="statistical-models-in-r-1.html#cb306-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept=</span>intercept, <span class="at">slope=</span>slope, <span class="at">colour=</span>agegp)) <span class="sc">+</span></span>
<span id="cb306-5"><a href="statistical-models-in-r-1.html#cb306-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_colour_discrete</span>(<span class="st">&quot;Age Group&quot;</span>) <span class="sc">+</span></span>
<span id="cb306-6"><a href="statistical-models-in-r-1.html#cb306-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">&quot;Number of Cases&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Number of Controls&quot;</span>)</span></code></pre></div>
<p><img src="ecoscope_datascience_workshops_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>So, each group still gets its own regression line, but tying the parameters together with a normal distribution gives us a more powerful regression.</p>
<div id="exercise-lme" class="section level4" number="5.7.3.1">
<h4><span class="header-section-number">5.7.3.1</span> Exercise: LME</h4>
<ol style="list-style-type: decimal">
<li><p>Using the <code>sleepstudy</code> dataset, fit an LME on Reaction against Days, grouped by Subject.</p></li>
<li><p>What is the intercept and slope of subject #310 in the model from question 1?</p></li>
<li><p>CHALLENGE. Using the Teams dataset from the <code>Lahman</code> package, fit a model on runs (<code>R</code>) from the variables ‘walks’ (<code>BB</code>) and ‘Hits’ (<code>H</code>), grouped by team (<code>teamID</code>).</p>
<ul>
<li><em>Hint</em>: wrap the scale function around each predictor variable.</li>
</ul></li>
</ol>
</div>
</div>
</div>
<div id="generalized-linear-models" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Generalized Linear models</h2>
<p>In the linear models discussed so far, we always assumed that
the response can take any numeric value or at least any numeric
value in a large range.</p>
<p>However, we often have response data that does not quite fit this assumption. This includes, for instance, count data that can only take non-negative integer values (<em>i.e.</em> 0, 1, 2, 3, …). Another example is binary data, where the response can take only one of
two values (<em>e.g.</em> yes/no, low/high, 0/1, etc.).</p>
<div id="definition" class="section level3" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Definition</h3>
<p>Generalized Linear Models (GLMs) are exactly what their name suggests, a generalization of linear models introduced to different kinds of data. With GLMs, we want to model the <em>mean</em> <span class="math inline">\(\mu\)</span> (or rather a function called <em>link</em>) of the assumed distribution as a linear function of some covariates.</p>
<p>The model can be written as
<span class="math display">\[
g(\mu) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p
\]</span>
and we want to estimate the parameters <span class="math inline">\(\beta_0\)</span> to <span class="math inline">\(\beta_p\)</span> for the <span class="math inline">\(p\)</span> covariates from the available data.</p>
<p>The choice of the distribution is guided by the type of the response
data (and the limited set of distributions for GLMs). The link function <span class="math inline">\(g()\)</span> is needed to convert the mean of the assumed distribution into a linear function of the model parameters, but it also makes it more difficult to interpret the parameters. The distributions usually have a “natural” link function, but other choices would be available too.</p>
<p>Before we discuss this in more detail, let’s see how we can actually fit a GLM in R.</p>
</div>
<div id="fitting-glms" class="section level3" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Fitting GLMs</h3>
<p>To fit a generalized linear model in R, we use the function <code>glm</code> which works very similarly to the already known <code>lm</code> function. However, it allows us to specify the distribution we want to use via the argument <code>family</code>. Each family comes with a default link function. The help page for <code>?family</code> lists all supported types of GLMs. We explore some of them below.</p>
</div>
<div id="logistic-regression-family-binomial" class="section level3" number="5.8.3">
<h3><span class="header-section-number">5.8.3</span> Logistic regression (<code>family = binomial</code>)</h3>
<p>We will first discuss the case of binary response data (<em>e.g.</em> no/yes, 0/1, failure/success, …). Oftentimes, we are interested in the probability of a <em>success</em> under certain circumstances, <em>i.e.</em>
we want to model the success probability given a set of covariates.</p>
<p>The natural choice for this kind of data is to use the Binomial distribution. This distribution corresponds to the number of successes in <span class="math inline">\(m\)</span> trials, if each trial is independent and has the same success probability. Binary data can be thought of as a single trial (<em>i.e.</em> <span class="math inline">\(m = 1\)</span>). The mean of the Binomial distribution is
the success probability <span class="math inline">\(p\)</span> and the usual link function is the log of the odds.</p>
<p>This gives us the logistic regression model:
<span class="math display">\[
\log \left( \frac{p}{1 - p} \right) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p
\]</span></p>
<p><strong>Importantly, each trial needs to be independent and must have the same success probability!</strong></p>
<p>As a first example, we will try logistic regression on the UC Berkeley Admission data (<code>UCBAdmissions</code>, pre-installed in R). We want to model log odds of being admitted, using the biological sex (incorrectly attributed as gender in the data set) of the applicant and the department as covariates.</p>
<p><em>Note</em>: The data set does not contain one row per applicant, but rather has the <em>number of applications</em> that fall in each of the possible combinations. This can be easily used in R via the <code>weights</code> argument to <code>glm</code>.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="statistical-models-in-r-1.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and format data</span></span>
<span id="cb307-2"><a href="statistical-models-in-r-1.html#cb307-2" aria-hidden="true" tabindex="-1"></a>ucb <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(UCBAdmissions) <span class="sc">%&gt;%</span> </span>
<span id="cb307-3"><a href="statistical-models-in-r-1.html#cb307-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">sex=</span>Gender)</span>
<span id="cb307-4"><a href="statistical-models-in-r-1.html#cb307-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit GLM binomial</span></span>
<span id="cb307-5"><a href="statistical-models-in-r-1.html#cb307-5" aria-hidden="true" tabindex="-1"></a>ucb_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(Admit <span class="sc">~</span> sex <span class="sc">*</span> Dept, </span>
<span id="cb307-6"><a href="statistical-models-in-r-1.html#cb307-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> ucb, </span>
<span id="cb307-7"><a href="statistical-models-in-r-1.html#cb307-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> binomial, </span>
<span id="cb307-8"><a href="statistical-models-in-r-1.html#cb307-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">weights =</span> Freq)</span>
<span id="cb307-9"><a href="statistical-models-in-r-1.html#cb307-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ucb_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = Admit ~ sex * Dept, family = binomial, data = ucb, 
##     weights = Freq)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -22.1022  -15.6975    0.3243   13.0256   24.6314  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -0.49212    0.07175  -6.859 6.94e-12 ***
## sexFemale       -1.05208    0.26271  -4.005 6.21e-05 ***
## DeptB           -0.04163    0.11319  -0.368  0.71304    
## DeptC            1.02764    0.13550   7.584 3.34e-14 ***
## DeptD            1.19608    0.12641   9.462  &lt; 2e-16 ***
## DeptE            1.44908    0.17681   8.196 2.49e-16 ***
## DeptF            3.26187    0.23120  14.109  &lt; 2e-16 ***
## sexFemale:DeptB  0.83205    0.51039   1.630  0.10306    
## sexFemale:DeptC  1.17700    0.29956   3.929 8.53e-05 ***
## sexFemale:DeptD  0.97009    0.30262   3.206  0.00135 ** 
## sexFemale:DeptE  1.25226    0.33032   3.791  0.00015 ***
## sexFemale:DeptF  0.86318    0.40267   2.144  0.03206 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 6044.3  on 23  degrees of freedom
## Residual deviance: 5167.3  on 12  degrees of freedom
## AIC: 5191.3
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The summary of the <code>glm</code> output shows us the value of each of the parameters as well as whether they are significantly different from 0. However, since our covariates are <em>categorical</em>, each of the two are reflected by multiple parameters (one for each “level” and combination of levels).</p>
<p>With the <code>Anova</code> function from the package <code>car</code>, we can check the significance of each of the two covariates as a whole.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="statistical-models-in-r-1.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(ucb_model)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: Admit
##          LR Chisq Df Pr(&gt;Chisq)    
## sex          1.53  1   0.215928    
## Dept       763.40  5  &lt; 2.2e-16 ***
## sex:Dept    20.20  5   0.001144 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>This tells us that <code>sex</code> by itself has no significant effect on the log-odds of being admitted, but the interaction effect with the department seems to be important. Hence, we can not remove any of the covariates without significantly degrading the fit.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="statistical-models-in-r-1.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(ucb_model, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## Admit ~ sex * Dept
##          Df Deviance    AIC    LRT Pr(&gt;Chi)   
## &lt;none&gt;        5167.3 5191.3                   
## sex:Dept  5   5187.5 5201.5 20.204 0.001144 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In GLMs with a link function (as in logistic regression), the interpretation of the parameters can be tricky. The sign of the parameter (<em>i.e.</em> is it positive or negative) can be interpreted as whether the covariate increases (“+”) or decreases (“-”) the odds,
and hence, the probability of success. Also, the relative magnitudes tell you which covariate increases/decreases the probability more. However, the magnitude itself is not directly interpretable, <em>i.e.</em> you can not say “the probability of being admitted is 1.05 less for females than for males.”</p>
<p>We can make statements about the probabilities themselves. The <code>lsmeans</code> function provides a nice overview of the fitted “success” (in our case “being admitted”) probabilities for the different combinations of the predictors, including a confidence interval.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="statistical-models-in-r-1.html#cb313-1" aria-hidden="true" tabindex="-1"></a>ucb_model_sum <span class="ot">&lt;-</span> <span class="fu">lsmeans</span>(ucb_model, <span class="sc">~</span> sex <span class="sc">+</span> Dept, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb313-2"><a href="statistical-models-in-r-1.html#cb313-2" aria-hidden="true" tabindex="-1"></a>ucb_model_sum</span></code></pre></div>
<pre><code>##  sex    Dept  prob     SE  df asymp.LCL asymp.UCL
##  Male   A    0.379 0.0169 Inf     0.347     0.413
##  Female A    0.176 0.0366 Inf     0.115     0.259
##  Male   B    0.370 0.0204 Inf     0.331     0.410
##  Female B    0.320 0.0933 Inf     0.169     0.522
##  Male   C    0.631 0.0268 Inf     0.577     0.682
##  Female C    0.659 0.0195 Inf     0.620     0.696
##  Male   D    0.669 0.0230 Inf     0.622     0.713
##  Female D    0.651 0.0246 Inf     0.601     0.697
##  Male   E    0.723 0.0324 Inf     0.655     0.781
##  Female E    0.761 0.0215 Inf     0.716     0.800
##  Male   F    0.941 0.0122 Inf     0.912     0.961
##  Female F    0.930 0.0139 Inf     0.897     0.952
## 
## Confidence level used: 0.95 
## Intervals are back-transformed from the logit scale</code></pre>
<p>This summary can also be grouped by one of the predictors, <em>e.g.</em> by the department.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="statistical-models-in-r-1.html#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ucb_model_sum, <span class="at">by =</span> <span class="st">&quot;Dept&quot;</span>)</span></code></pre></div>
<pre><code>## Dept = A:
##  sex     prob     SE  df asymp.LCL asymp.UCL
##  Male   0.379 0.0169 Inf     0.347     0.413
##  Female 0.176 0.0366 Inf     0.115     0.259
## 
## Dept = B:
##  sex     prob     SE  df asymp.LCL asymp.UCL
##  Male   0.370 0.0204 Inf     0.331     0.410
##  Female 0.320 0.0933 Inf     0.169     0.522
## 
## Dept = C:
##  sex     prob     SE  df asymp.LCL asymp.UCL
##  Male   0.631 0.0268 Inf     0.577     0.682
##  Female 0.659 0.0195 Inf     0.620     0.696
## 
## Dept = D:
##  sex     prob     SE  df asymp.LCL asymp.UCL
##  Male   0.669 0.0230 Inf     0.622     0.713
##  Female 0.651 0.0246 Inf     0.601     0.697
## 
## Dept = E:
##  sex     prob     SE  df asymp.LCL asymp.UCL
##  Male   0.723 0.0324 Inf     0.655     0.781
##  Female 0.761 0.0215 Inf     0.716     0.800
## 
## Dept = F:
##  sex     prob     SE  df asymp.LCL asymp.UCL
##  Male   0.941 0.0122 Inf     0.912     0.961
##  Female 0.930 0.0139 Inf     0.897     0.952
## 
## Confidence level used: 0.95 
## Intervals are back-transformed from the logit scale</code></pre>
<p>Similarly, we can get the <em>odds ratio</em> between males and females in each department. This basically tells us how different the odds are between male and female applicants in each department.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="statistical-models-in-r-1.html#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(ucb_model_sum, <span class="st">&quot;pairwise&quot;</span>, <span class="at">by =</span> <span class="st">&quot;Dept&quot;</span>)</span></code></pre></div>
<pre><code>## Dept = A:
##  contrast      odds.ratio    SE  df z.ratio p.value
##  Male / Female      2.864 0.752 Inf  4.005  0.0001 
## 
## Dept = B:
##  contrast      odds.ratio    SE  df z.ratio p.value
##  Male / Female      1.246 0.545 Inf  0.503  0.6151 
## 
## Dept = C:
##  contrast      odds.ratio    SE  df z.ratio p.value
##  Male / Female      0.883 0.127 Inf -0.868  0.3855 
## 
## Dept = D:
##  contrast      odds.ratio    SE  df z.ratio p.value
##  Male / Female      1.085 0.163 Inf  0.546  0.5852 
## 
## Dept = E:
##  contrast      odds.ratio    SE  df z.ratio p.value
##  Male / Female      0.819 0.164 Inf -1.000  0.3174 
## 
## Dept = F:
##  contrast      odds.ratio    SE  df z.ratio p.value
##  Male / Female      1.208 0.369 Inf  0.619  0.5359 
## 
## Tests are performed on the log odds ratio scale</code></pre>
<p>This tells us that sex seems to make a significant difference in Department <span class="math inline">\(A\)</span> but not so in the other departments. This, in turn,
causes the significant interaction effect we saw before.</p>
<div id="exercise-logistic-glm" class="section level4" number="5.8.3.1">
<h4><span class="header-section-number">5.8.3.1</span> Exercise: Logistic GLM</h4>
<ol style="list-style-type: decimal">
<li><p>In the plasma data (from the <code>HSAUR3</code> package), use logistic regression to estimate the probabilities of ESR &gt; 20, given the level of fibrinogen in the blood.</p></li>
<li><p>Using the <code>womensrole</code> data set from the <code>HSAUR3</code> package, try to fit a logistic regression to the agreement with the statement, given the years of education and the respondent’s sex (also attributed as <code>gender</code> in these data).</p></li>
</ol>
</div>
</div>
<div id="count-data-family-poisson" class="section level3" number="5.8.4">
<h3><span class="header-section-number">5.8.4</span> Count data (<code>family = poisson</code>)</h3>
<p>When we are dealing with count data, the Poisson distribution is often used as a model. The Poisson distribution models the number of events during a fixed period of time (or space, etc.). It is completely characterized by the <em>rate</em> parameter <span class="math inline">\(\mu\)</span>. Both the mean and the variance of the Poisson distribution are equal to the <em>rate</em> parameter. In other words, a larger <em>rate</em> also implies a larger spread of the data. This is a rather strong assumption and we will learn how to check if this assumption is reasonable for a given data set. The usual link function for Poisson GLMs is the log, so
our GLM for the rate <span class="math inline">\(\mu\)</span> is:
<span class="math display">\[
    \log (\mu) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_p x_p.
\]</span></p>
<p>Let’s use this model on the <code>polyps</code> data set (pre-installed). We want to explain the number of colonic polyps at 12 months by means of the age of the patient and whether they are in the treatment group.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="statistical-models-in-r-1.html#cb319-1" aria-hidden="true" tabindex="-1"></a>polyps_model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(number <span class="sc">~</span> treat <span class="sc">+</span> age,</span>
<span id="cb319-2"><a href="statistical-models-in-r-1.html#cb319-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> polyps,</span>
<span id="cb319-3"><a href="statistical-models-in-r-1.html#cb319-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">family =</span> poisson)</span>
<span id="cb319-4"><a href="statistical-models-in-r-1.html#cb319-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polyps_model1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = number ~ treat + age, family = poisson, data = polyps)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.2212  -3.0536  -0.1802   1.4459   5.8301  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  4.529024   0.146872   30.84  &lt; 2e-16 ***
## treatdrug   -1.359083   0.117643  -11.55  &lt; 2e-16 ***
## age         -0.038830   0.005955   -6.52 7.02e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 378.66  on 19  degrees of freedom
## Residual deviance: 179.54  on 17  degrees of freedom
## AIC: 273.88
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>We assumed that the mean and the variance are equal. But how close is this assumption to the truth? R supports the “quasi-” family which allows for the variance to be different.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="statistical-models-in-r-1.html#cb321-1" aria-hidden="true" tabindex="-1"></a>polyps_model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(number <span class="sc">~</span> treat <span class="sc">+</span> age, </span>
<span id="cb321-2"><a href="statistical-models-in-r-1.html#cb321-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> polyps, </span>
<span id="cb321-3"><a href="statistical-models-in-r-1.html#cb321-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> quasipoisson)</span>
<span id="cb321-4"><a href="statistical-models-in-r-1.html#cb321-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(polyps_model2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = number ~ treat + age, family = quasipoisson, data = polyps)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.2212  -3.0536  -0.1802   1.4459   5.8301  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.52902    0.48106   9.415 3.72e-08 ***
## treatdrug   -1.35908    0.38533  -3.527  0.00259 ** 
## age         -0.03883    0.01951  -1.991  0.06284 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 10.72805)
## 
##     Null deviance: 378.66  on 19  degrees of freedom
## Residual deviance: 179.54  on 17  degrees of freedom
## AIC: NA
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The fitted quasi-Poisson model results in dispersion parameter different from 1, which makes the assumption of equal mean and variance highly questionable. If the assumption of equal mean and variance is wrong, the standard errors of the parameters are grossly underestimated. The uncoupling of the mean and the variance does not change the parameter estimates, but the significance of the parameters in the model will be different.</p>
<p>Similarly to logistic regression, we can investigate the difference in the rate between two levels of a categorical covariate:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="statistical-models-in-r-1.html#cb323-1" aria-hidden="true" tabindex="-1"></a>polyps_model2_sum <span class="ot">&lt;-</span> <span class="fu">lsmeans</span>(polyps_model2, <span class="sc">~</span> treat, </span>
<span id="cb323-2"><a href="statistical-models-in-r-1.html#cb323-2" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb323-3"><a href="statistical-models-in-r-1.html#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrast</span>(polyps_model2_sum, <span class="st">&quot;pairwise&quot;</span>)</span></code></pre></div>
<pre><code>##  contrast       ratio  SE  df z.ratio p.value
##  placebo / drug  3.89 1.5 Inf 3.527   0.0004 
## 
## Tests are performed on the log scale</code></pre>
<p>The significant (p= <span class="math inline">\(4.2012649\times 10^{-4}\)</span>) <code>rate.ratio</code> of <span class="math inline">\(3.8926236\)</span> tells us that the rate of the number of colonic polyps at 12 months for subjects in the placebo group is <span class="math inline">\(3.8926236\)</span> times higher than for subjects in the treatment group.</p>
<div id="exercise-poisson-glm" class="section level4" number="5.8.4.1">
<h4><span class="header-section-number">5.8.4.1</span> Exercise: Poisson GLM</h4>
<ol style="list-style-type: decimal">
<li>Check which <em>covariates</em> have a significant effect on the response in the model fitted with the Poisson family and with the quasi-Poisson family and compare the results. What do you observe?</li>
</ol>
</div>
</div>
<div id="negative-binomial-model-for-count-data" class="section level3" number="5.8.5">
<h3><span class="header-section-number">5.8.5</span> Negative binomial model for count data</h3>
<p>An over-dispersed Poisson regression model (<em>i.e.</em> fitted with quasi-Poisson) is similar to a Negative Binomial (NB) regression model. This can be fitted with the <code>glm.nb</code> function from the <code>MASS</code> package. For instance, we can model the days absent from school based on the sex of students, their age, ethnic background, and learner status. These data are within <code>quine</code> from this same package.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="statistical-models-in-r-1.html#cb325-1" aria-hidden="true" tabindex="-1"></a>quine_model <span class="ot">&lt;-</span> <span class="fu">glm.nb</span>(Days <span class="sc">~</span> Sex <span class="sc">*</span> (Age <span class="sc">+</span> Eth <span class="sc">*</span> Lrn), </span>
<span id="cb325-2"><a href="statistical-models-in-r-1.html#cb325-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">data =</span> quine)</span>
<span id="cb325-3"><a href="statistical-models-in-r-1.html#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="do">## equivalent to</span></span>
<span id="cb325-4"><a href="statistical-models-in-r-1.html#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="do">## quine_model &lt;- glm.nb(Days ~ Sex * Age + Sex * Eth * Lrn, data = quine)</span></span>
<span id="cb325-5"><a href="statistical-models-in-r-1.html#cb325-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-6"><a href="statistical-models-in-r-1.html#cb325-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quine_model)</span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = Days ~ Sex * (Age + Eth * Lrn), data = quine, 
##     init.theta = 1.597990733, link = log)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.8950  -0.8827  -0.2299   0.5669   2.1071  
## 
## Coefficients:
##                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)      3.01919    0.29706  10.163  &lt; 2e-16 ***
## SexM            -0.47541    0.39550  -1.202 0.229355    
## AgeF1           -0.70887    0.32321  -2.193 0.028290 *  
## AgeF2           -0.61486    0.37141  -1.655 0.097826 .  
## AgeF3           -0.34235    0.32717  -1.046 0.295388    
## EthN            -0.07312    0.26539  -0.276 0.782908    
## LrnSL            0.94358    0.32246   2.926 0.003432 ** 
## EthN:LrnSL      -1.35849    0.37719  -3.602 0.000316 ***
## SexM:AgeF1      -0.01486    0.46225  -0.032 0.974353    
## SexM:AgeF2       1.24328    0.46134   2.695 0.007040 ** 
## SexM:AgeF3       1.49319    0.45337   3.294 0.000989 ***
## SexM:EthN       -0.60586    0.36896  -1.642 0.100572    
## SexM:LrnSL      -0.70467    0.46536  -1.514 0.129966    
## SexM:EthN:LrnSL  2.11991    0.58056   3.651 0.000261 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1.598) family taken to be 1)
## 
##     Null deviance: 234.56  on 145  degrees of freedom
## Residual deviance: 167.56  on 132  degrees of freedom
## AIC: 1093
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.598 
##           Std. Err.:  0.213 
## 
##  2 x log-likelihood:  -1063.025</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="statistical-models-in-r-1.html#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(quine_model)</span></code></pre></div>
<pre><code>## Analysis of Deviance Table (Type II tests)
## 
## Response: Days
##             LR Chisq Df Pr(&gt;Chisq)    
## Sex           0.9284  1  0.3352783    
## Age          14.9609  3  0.0018503 ** 
## Eth          16.9573  1  3.823e-05 ***
## Lrn           5.6903  1  0.0170588 *  
## Eth:Lrn       2.5726  1  0.1087268    
## Sex:Age      19.8297  3  0.0001841 ***
## Sex:Eth       0.6547  1  0.4184372    
## Sex:Lrn       1.4965  1  0.2212106    
## Sex:Eth:Lrn  12.9647  1  0.0003174 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>From the ANOVA table we see that several terms are not significant, but the highest order term involving any of the four factors is significant. Therefore we cannot remove any terms from the model.</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="statistical-models-in-r-1.html#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(quine_model, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span></code></pre></div>
<pre><code>## Single term deletions
## 
## Model:
## Days ~ Sex * (Age + Eth * Lrn)
##             Df Deviance    AIC    LRT  Pr(&gt;Chi)    
## &lt;none&gt;           167.56 1091.0                     
## Sex:Age      3   187.39 1104.8 19.830 0.0001841 ***
## Sex:Eth:Lrn  1   180.52 1102.0 12.965 0.0003174 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We can use <code>lsmeans</code> to compare groups but the relationships are hard to interpret
because there are high order interaction terms in the model.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="statistical-models-in-r-1.html#cb331-1" aria-hidden="true" tabindex="-1"></a>quine_model_sum1 <span class="ot">&lt;-</span> <span class="fu">lsmeans</span>(quine_model, <span class="sc">~</span> Sex <span class="sc">+</span> Eth <span class="sc">+</span> Lrn, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb331-2"><a href="statistical-models-in-r-1.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quine_model_sum1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Eth&quot;</span>))</span></code></pre></div>
<pre><code>## Sex = F, Eth = A:
##  Lrn response   SE  df asymp.LCL asymp.UCL
##  AL     13.50 2.78 Inf      9.01      20.2
##  SL     34.68 7.63 Inf     22.53      53.4
## 
## Sex = M, Eth = A:
##  Lrn response   SE  df asymp.LCL asymp.UCL
##  AL     16.57 3.12 Inf     11.46      24.0
##  SL     21.04 5.73 Inf     12.35      35.9
## 
## Sex = F, Eth = N:
##  Lrn response   SE  df asymp.LCL asymp.UCL
##  AL     12.55 2.49 Inf      8.50      18.5
##  SL      8.29 1.87 Inf      5.33      12.9
## 
## Sex = M, Eth = N:
##  Lrn response   SE  df asymp.LCL asymp.UCL
##  AL      8.40 1.60 Inf      5.78      12.2
##  SL     22.85 5.76 Inf     13.94      37.5
## 
## Results are averaged over the levels of: Age 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale</code></pre>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="statistical-models-in-r-1.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quine_model_sum1, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;Eth&quot;</span>, <span class="st">&quot;Lrn&quot;</span>))</span></code></pre></div>
<pre><code>## Eth = A, Lrn = AL:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      13.50 2.78 Inf      9.01      20.2
##  M      16.57 3.12 Inf     11.46      24.0
## 
## Eth = N, Lrn = AL:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      12.55 2.49 Inf      8.50      18.5
##  M       8.40 1.60 Inf      5.78      12.2
## 
## Eth = A, Lrn = SL:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      34.68 7.63 Inf     22.53      53.4
##  M      21.04 5.73 Inf     12.35      35.9
## 
## Eth = N, Lrn = SL:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F       8.29 1.87 Inf      5.33      12.9
##  M      22.85 5.76 Inf     13.94      37.5
## 
## Results are averaged over the levels of: Age 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="statistical-models-in-r-1.html#cb335-1" aria-hidden="true" tabindex="-1"></a>quine_model_sum2 <span class="ot">&lt;-</span> <span class="fu">lsmeans</span>(quine_model, <span class="sc">~</span> Sex <span class="sc">+</span> Age, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb335-2"><a href="statistical-models-in-r-1.html#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quine_model_sum2, <span class="at">by =</span> <span class="st">&quot;Sex&quot;</span>)</span></code></pre></div>
<pre><code>## Sex = F:
##  Age response   SE  df asymp.LCL asymp.UCL
##  F0     22.53 6.11 Inf     13.23     38.35
##  F1     11.09 1.73 Inf      8.16     15.06
##  F2     12.18 2.68 Inf      7.92     18.74
##  F3     16.00 3.70 Inf     10.16     25.19
## 
## Sex = M:
##  Age response   SE  df asymp.LCL asymp.UCL
##  F0     12.36 2.58 Inf      8.21     18.60
##  F1      5.99 1.49 Inf      3.68      9.76
##  F2     23.16 4.26 Inf     16.15     33.22
##  F3     39.05 9.80 Inf     23.88     63.87
## 
## Results are averaged over the levels of: Eth, Lrn 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="statistical-models-in-r-1.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(quine_model_sum2, <span class="at">by =</span> <span class="st">&quot;Age&quot;</span>)</span></code></pre></div>
<pre><code>## Age = F0:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      22.53 6.11 Inf     13.23     38.35
##  M      12.36 2.58 Inf      8.21     18.60
## 
## Age = F1:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      11.09 1.73 Inf      8.16     15.06
##  M       5.99 1.49 Inf      3.68      9.76
## 
## Age = F2:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      12.18 2.68 Inf      7.92     18.74
##  M      23.16 4.26 Inf     16.15     33.22
## 
## Age = F3:
##  Sex response   SE  df asymp.LCL asymp.UCL
##  F      16.00 3.70 Inf     10.16     25.19
##  M      39.05 9.80 Inf     23.88     63.87
## 
## Results are averaged over the levels of: Eth, Lrn 
## Confidence level used: 0.95 
## Intervals are back-transformed from the log scale</code></pre>
<div id="exercise-quasi-poisson-vs.-negative-binomial-glm" class="section level4" number="5.8.5.1">
<h4><span class="header-section-number">5.8.5.1</span> Exercise: Quasi-Poisson vs. negative binomial GLM</h4>
<ol style="list-style-type: decimal">
<li>Fit the above model with a quasi-Poisson family and check the over-dispersion in that fit. Is there a difference in the significance of any terms compared to the NB model? Would a Poisson model be appropriate as well?</li>
</ol>
</div>
</div>
</div>
<div id="survey-3" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Survey</h2>
<p>Please provide us with feedback through this <a href="https://ubc.ca1.qualtrics.com/jfe/form/SV_2tOcP5OKnCNyauV">short survey</a>.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reproducible-research-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="intermediate-r-programming-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["ecoscope_datascience_workshops.pdf", "ecoscope_datascience_workshops.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
